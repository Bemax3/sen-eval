import{b as X,T as B,r as C,d as O,w as R,o as d,e as x,f as i,Q as Z,g as a,u as t,Z as K,a as e,t as w,h as ee,k as U,c as p,i as M,F as Y,j as y,p as se,n as c}from"./app-bdcf5fce.js";import{_ as te,i as ae,c as q,m as A}from"./AuthenticatedLayout-3c3c1141.js";import{_ as le}from"./Breadcrumbs-e4217e77.js";import{_}from"./TextInput-88ee3124.js";import{_ as re}from"./SubmitButton-b13be7c5.js";import{_ as oe}from"./InputLabel-7d6a1be0.js";import{r as m}from"./LockClosedIcon-396a8204.js";import{r as L}from"./ChevronUpDownIcon-d20f7720.js";import{r as P}from"./CheckIcon-d48787d5.js";import{W as E,Q as G,G as S,X as j,J as H,Y as I}from"./combobox-f65bf4aa.js";import{N as ie,H as ne,B as de,U as ue}from"./listbox-82a4ddd5.js";import"./logo1637145113-11387d37.js";import"./use-controllable-126a179b.js";const me={class:"px-4 sm:px-6 lg:px-8"},ce={class:"sm:flex sm:items-center"},_e={class:"sm:flex-auto"},ge={class:"text-2xl font-semibold leading-6 text-gray-900"},pe=e("p",{class:"mt-2 text-sm text-gray-700"}," Informations personnelles et administratives de l'agent. ",-1),fe={class:"mt-8 shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg bg-white"},he={class:"grid max-w-7xl grid-cols-1 gap-x-8 gap-y-10 px-4 py-16 sm:px-6 md:grid-cols-3 lg:px-8"},xe=e("div",null,[e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informations Personnelles"),e("p",{class:"mt-1 text-sm leading-6 text-gray-400"},"Vous ne pouvez pas modifier ces informations.")],-1),ye={class:"md:col-span-2"},ve={class:"grid grid-cols-1 gap-x-6 gap-y-8 sm:max-w-xl sm:grid-cols-6"},be=e("div",{class:"col-span-full flex items-center gap-x-8"},[e("img",{alt:"",class:"h-24 w-24 flex-none rounded-lg bg-cyan-600 object-cover"})],-1),we={class:"sm:col-span-3"},Ve=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"first-name"},"Prénom",-1),ke={class:"relative shadow-sm rounded-md mt-2"},Ce={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Ue={class:"sm:col-span-3"},Ne=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"last-name"},"Nom",-1),De={class:"relative shadow-sm rounded-md mt-2"},Me={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Ye={class:"col-span-full"},Le=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"email"},"Email",-1),Pe={class:"relative shadow-sm rounded-md mt-2"},Fe={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},$e={class:"grid max-w-7xl grid-cols-1 gap-x-8 gap-y-10 px-4 py-16 sm:px-6 md:grid-cols-3 lg:px-8 border-t-2"},ze=e("div",null,[e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informations Administratives"),e("p",{class:"mt-1 text-sm leading-6 text-gray-400"},"Changer le supérieur hiérarchique de l'agent ou son organisation.")],-1),Be=["onSubmit"],Oe={class:"grid grid-cols-1 gap-x-6 gap-y-8 sm:max-w-xl sm:grid-cols-6"},Re={class:"col-span-full"},qe={class:"relative mt-2"},Ae={class:"flex"},Ee={class:"col-span-full"},Ge=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"confirm-password"},"Poste",-1),Se={class:"relative shadow-sm rounded-md mt-2"},je={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},He={class:"col-span-full"},Ie=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"confirm-password"},"College",-1),Qe={class:"relative shadow-sm rounded-md mt-2"},Te={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Je={class:"sm:col-span-3"},We=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"first-name"},"Matricule",-1),Xe={class:"relative shadow-sm rounded-md mt-2"},Ze={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Ke={class:"sm:col-span-3"},es=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"last-name"},"Centre de Responsabilité",-1),ss={class:"relative shadow-sm rounded-md mt-2"},ts={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},as={class:"sm:col-span-3"},ls=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"first-name"},"GF",-1),rs={class:"relative shadow-sm rounded-md mt-2"},os={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},is={class:"sm:col-span-3"},ns=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"last-name"},"NR",-1),ds={class:"relative shadow-sm rounded-md mt-2"},us={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},ms={class:"sm:col-span-3"},cs=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"first-name"},"Date Promotion GF",-1),_s={class:"relative shadow-sm rounded-md mt-2"},gs=["value"],ps={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},fs={class:"sm:col-span-3"},hs=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"last-name"},"Date Promotion NR",-1),xs={class:"relative shadow-sm rounded-md mt-2"},ys=["value"],vs={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},bs={key:0,class:"sm:col-span-4"},ws={class:"mt-2"},Vs={class:"relative mt-2"},ks={class:"block truncate"},Cs={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"},Us={class:"col-span-full"},Ns={class:"relative mt-2"},Ds={class:"flex"},Ms={class:"mt-8 flex"},js={__name:"Profile",props:{user:{type:Object},n1s:{type:Array},orgs:{type:Array},roles:{type:Array}},setup(f){const r=f,F=X(()=>Z().props.auth.user.role_id===1),Q=[{name:"Profil",href:"#",current:!0}],g=B(F?{n1_id:r.user.n1?r.user.n1.user_id:-1,org_id:r.user.org?r.user.org.org_id:null,role_id:r.user.role.role_id}:{n1_id:r.user.n1?r.user.n1.user_id:-1,org_id:r.user.org?r.user.org.org_id:null}),N=r.orgs,V=C(""),v=C(N),$=O({keyword:"",fields:["org_name","org_responsibility_center"]}),D=r.n1s,k=C(""),b=C(D),z=O({keyword:"",fields:["user_matricule","user_display_name"]}),o=(()=>B(ae(r.user)?{}:{user_first_name:r.user.user_first_name||"",user_last_name:r.user.user_last_name||"",email:r.user.email||"",org_name:r.user.org?r.user.org.org_name:"",user_title:r.user.user_title||"",user_matricule:r.user.user_matricule||"",group_name:r.user.group?r.user.group.group_name:"",user_responsibility_center:r.user.user_responsibility_center||"",user_gf:r.user.user_gf||"",user_nr:r.user.user_nr||"",user_gf_prom_date:r.user.user_gf_prom_date||"",user_nr_prom_date:r.user.user_nr_prom_date||""}))(),T=()=>g.put(route("profile.update",{profile:r.user.user_id})),J=()=>axios.post(route("users.search"),z),W=()=>axios.post(route("orgs.search"),$);return R(()=>k.value,function(h){let l=h===""?D:D.filter(s=>s.user_matricule.toLowerCase().includes(k.value.toLowerCase())||s.user_display_name.toLowerCase().includes(k.value.toLowerCase()));l.length>0?b.value=l:h.length>=3&&J().then(s=>b.value=s.data)}),R(()=>V.value,function(h){let l=h===""?N:N.filter(s=>s.org_name.toLowerCase().includes(V.value.toLowerCase())||s.org_responsibility_center.toLowerCase().includes(V.value.toLowerCase()));l.length>0?v.value=l:h.length>=3&&W().then(s=>v.value=s.data)}),(h,l)=>(d(),x(te,null,{default:i(()=>[a(t(K),{title:"Profil"}),e("div",me,[a(le,{pages:Q}),e("div",ce,[e("div",_e,[e("h1",ge,"Profil de "+w(f.user.user_display_name),1),pe])]),e("div",fe,[e("div",he,[xe,e("form",ye,[e("div",ve,[be,e("div",we,[Ve,e("div",ke,[a(_,{modelValue:t(o).user_first_name,"onUpdate:modelValue":l[0]||(l[0]=s=>t(o).user_first_name=s),disabled:!0},null,8,["modelValue"]),e("div",Ce,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",Ue,[Ne,e("div",De,[a(_,{modelValue:t(o).user_last_name,"onUpdate:modelValue":l[1]||(l[1]=s=>t(o).user_last_name=s),disabled:!0},null,8,["modelValue"]),e("div",Me,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",Ye,[Le,e("div",Pe,[a(_,{modelValue:t(o).email,"onUpdate:modelValue":l[2]||(l[2]=s=>t(o).email=s),disabled:!0},null,8,["modelValue"]),e("div",Fe,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])])])])]),e("div",$e,[ze,e("form",{class:"md:col-span-2",onSubmit:ee(T,["prevent"])},[e("div",Oe,[e("div",Re,[a(t(H),{modelValue:t(g).org_id,"onUpdate:modelValue":l[4]||(l[4]=s=>t(g).org_id=s),as:"div"},{default:i(()=>[a(t(E),{class:"block text-sm font-medium leading-6 text-gray-900"},{default:i(()=>[U("Organisation")]),_:1}),e("div",qe,[a(t(G),{"display-value":s=>{let n=v.value.filter(u=>u.org_id===s)[0]||f.user.org;return n?n.org_name+" "+n.org_responsibility_center:"Non défini"},class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-12 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-cyan-600 sm:text-sm sm:leading-6",onChange:l[3]||(l[3]=s=>{$.keyword=V.value=s.target.value})},null,8,["display-value"]),a(t(S),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:i(()=>[a(t(L),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})]),_:1}),v.value.length>0?(d(),x(t(j),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:i(()=>[(d(!0),p(Y,null,M(v.value,s=>(d(),x(t(I),{key:s.org_id,value:s.org_id,as:"template"},{default:i(({active:n,selected:u})=>[e("li",{class:c(["relative cursor-default select-none py-2 pl-3 pr-9",n?"bg-cyan-600 text-white":"text-gray-900"])},[e("div",Ae,[e("span",{class:c(["truncate",u&&"font-semibold"])},w((s==null?void 0:s.org_name)+" --> "+(s==null?void 0:s.org_responsibility_center)),3)]),u?(d(),p("span",{key:0,class:c(["absolute inset-y-0 right-0 flex items-center pr-4",n?"text-white":"text-cyan-600"])},[a(t(P),{"aria-hidden":"true",class:"h-5 w-5"})],2)):y("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):y("",!0)])]),_:1},8,["modelValue"])]),e("div",Ee,[Ge,e("div",Se,[a(_,{modelValue:t(o).user_title,"onUpdate:modelValue":l[5]||(l[5]=s=>t(o).user_title=s),disabled:!0},null,8,["modelValue"]),e("div",je,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",He,[Ie,e("div",Qe,[a(_,{modelValue:t(o).group_name,"onUpdate:modelValue":l[6]||(l[6]=s=>t(o).group_name=s),disabled:!0},null,8,["modelValue"]),e("div",Te,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",Je,[We,e("div",Xe,[a(_,{modelValue:t(o).user_matricule,"onUpdate:modelValue":l[7]||(l[7]=s=>t(o).user_matricule=s),disabled:!0},null,8,["modelValue"]),e("div",Ze,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",Ke,[es,e("div",ss,[a(_,{modelValue:t(o).user_responsibility_center,"onUpdate:modelValue":l[8]||(l[8]=s=>t(o).user_responsibility_center=s),disabled:!0},null,8,["modelValue"]),e("div",ts,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",as,[ls,e("div",rs,[a(_,{modelValue:t(o).user_gf,"onUpdate:modelValue":l[9]||(l[9]=s=>t(o).user_gf=s),disabled:!0},null,8,["modelValue"]),e("div",os,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",is,[ns,e("div",ds,[a(_,{modelValue:t(o).user_nr,"onUpdate:modelValue":l[10]||(l[10]=s=>t(o).user_nr=s),disabled:!0},null,8,["modelValue"]),e("div",us,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",ms,[cs,e("div",_s,[e("input",{disabled:!0,value:t(q)(t(A)(t(o).user_gf_prom_date).format("DD MMMM YYYY")),class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"},null,8,gs),e("div",ps,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",fs,[hs,e("div",xs,[e("input",{disabled:!0,value:t(q)(t(A)(t(o).user_nr_prom_date).format("DD MMMM YYYY")),class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"},null,8,ys),e("div",vs,[a(t(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),F.value?(d(),p("div",bs,[a(oe,null,{default:i(()=>[U("Role")]),_:1}),e("div",ws,[a(t(de),{modelValue:t(g).role_id,"onUpdate:modelValue":l[11]||(l[11]=s=>t(g).role_id=s),as:"div"},{default:i(()=>[e("div",Vs,[a(t(ie),{class:"relative w-full cursor-default rounded-md bg-white py-1.5 pl-3 pr-10 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-cyan-600 sm:text-sm sm:leading-6"},{default:i(()=>[e("span",ks,w(f.roles.filter(s=>s.role_id===t(g).role_id)[0].role_name),1),e("span",Cs,[a(t(L),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])]),_:1}),a(se,{"leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:i(()=>[a(t(ne),{class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:i(()=>[(d(!0),p(Y,null,M(f.roles,s=>(d(),x(t(ue),{key:s.role_id,value:s.role_id,as:"template"},{default:i(({active:n,selected:u})=>[e("li",{class:c([n?"bg-cyan-600 text-white":"text-gray-900","relative cursor-default select-none py-2 pl-3 pr-9"])},[e("span",{class:c([u?"font-semibold":"font-normal","block truncate"])},w(s.role_name),3),u?(d(),p("span",{key:0,class:c([n?"text-white":"text-cyan-600","absolute inset-y-0 right-0 flex items-center pr-4"])},[a(t(P),{"aria-hidden":"true",class:"h-5 w-5"})],2)):y("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])])])):y("",!0),e("div",Us,[a(t(H),{modelValue:t(g).n1_id,"onUpdate:modelValue":l[13]||(l[13]=s=>t(g).n1_id=s),as:"div"},{default:i(()=>[a(t(E),{class:"block text-sm font-medium leading-6 text-gray-900"},{default:i(()=>[U("Supérieure Hiérarchique (N + 1)")]),_:1}),e("div",Ns,[a(t(G),{"display-value":s=>{let n=b.value.filter(u=>u.user_id===s)[0]||f.user.n1;return n?n.user_matricule+" "+n.user_display_name:"Non défini"},class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-12 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-cyan-600 sm:text-sm sm:leading-6",onChange:l[12]||(l[12]=s=>{z.keyword=k.value=s.target.value})},null,8,["display-value"]),a(t(S),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:i(()=>[a(t(L),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})]),_:1}),b.value.length>0?(d(),x(t(j),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:i(()=>[(d(!0),p(Y,null,M(b.value,s=>(d(),x(t(I),{key:s.user_id,value:s.user_id,as:"template"},{default:i(({active:n,selected:u})=>[e("li",{class:c(["relative cursor-default select-none py-2 pl-3 pr-9",n?"bg-cyan-600 text-white":"text-gray-900"])},[e("div",Ds,[e("span",{class:c(["truncate",u&&"font-semibold"])},w((s==null?void 0:s.user_matricule)+" "+(s==null?void 0:s.user_display_name)),3)]),u?(d(),p("span",{key:0,class:c(["absolute inset-y-0 right-0 flex items-center pr-4",n?"text-white":"text-cyan-600"])},[a(t(P),{"aria-hidden":"true",class:"h-5 w-5"})],2)):y("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):y("",!0)])]),_:1},8,["modelValue"])])]),e("div",Ms,[a(re,null,{default:i(()=>[U("Enregistrer")]),_:1})])],40,Be)])])])]),_:1}))}};export{js as default};
