import{b as X,T as O,r as U,d as z,w as E,o as d,e as x,f as i,Q as Z,g as a,u as s,Z as K,a as e,t as w,k as V,h as ee,c as f,i as Y,F as L,j as y,p as se,n as c}from"./app-90af8dda.js";import{_ as te,i as ae,c as R,m as A}from"./AuthenticatedLayout-21404ea0.js";import{_ as le}from"./Breadcrumbs-ade623fb.js";import{_}from"./TextInput-7a951507.js";import{_ as re}from"./SubmitButton-2f245c71.js";import{_ as oe}from"./InputLabel-cbeee303.js";import{r as m}from"./LockClosedIcon-3ef21c39.js";import{r as N}from"./CheckIcon-c5d064d9.js";import{r as P}from"./ChevronUpDownIcon-8a8054f0.js";import{W as G,Q as S,G as j,X as q,J as H,Y as I}from"./combobox-9f0889c9.js";import{N as ie,H as ne,B as de,U as ue}from"./listbox-f01e3530.js";import"./logo1637145113-11387d37.js";import"./use-controllable-ba619346.js";const me={class:"px-4 sm:px-6 lg:px-8"},ce={class:"sm:flex sm:items-center"},_e={class:"sm:flex-auto"},ge={class:"text-2xl font-semibold leading-6 text-gray-900"},fe=e("p",{class:"mt-2 text-sm text-gray-700"}," Informations personnelles et administratives de l'agent. ",-1),pe={class:"mt-8 shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg bg-white"},he={class:"grid max-w-7xl grid-cols-1 gap-x-8 gap-y-10 px-4 py-16 sm:px-6 md:grid-cols-3 lg:px-8"},xe=e("div",null,[e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informations Personnelles"),e("p",{class:"mt-1 text-sm leading-6 text-gray-400"},"Changer les informations personnelles de cette agents")],-1),ye={class:"md:col-span-2"},ve={class:"grid grid-cols-1 gap-x-6 gap-y-8 sm:max-w-xl sm:grid-cols-6"},be=e("div",{class:"col-span-full flex items-center gap-x-8"},[e("img",{alt:"",class:"h-24 w-24 flex-none rounded-lg bg-cyan-600 object-cover"})],-1),we={class:"sm:col-span-3"},Ve=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"first-name"},"Prénom",-1),ke={class:"relative shadow-sm rounded-md mt-2"},Ce={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Ue={class:"sm:col-span-3"},Ne=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"last-name"},"Nom",-1),De={class:"relative shadow-sm rounded-md mt-2"},Me={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Ye={class:"col-span-full"},Le=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"email"},"Email",-1),Pe={class:"relative shadow-sm rounded-md mt-2"},Fe={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},$e={class:"mt-8 flex"},Be={disabled:!0,class:"inline-flex gap-x-1.5 disabled:opacity-70 rounded-md bg-cyan-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-cyan-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",type:"submit"},Oe={class:"grid max-w-7xl grid-cols-1 gap-x-8 gap-y-10 px-4 py-16 sm:px-6 md:grid-cols-3 lg:px-8 border-t-2"},ze=e("div",null,[e("h2",{class:"text-base font-semibold leading-7 text-gray-900"},"Informations Administratives"),e("p",{class:"mt-1 text-sm leading-6 text-gray-400"},"Modifier les informations administrative.")],-1),Ee=["onSubmit"],Re={class:"grid grid-cols-1 gap-x-6 gap-y-8 sm:max-w-xl sm:grid-cols-6"},Ae={class:"col-span-full"},Ge={class:"relative mt-2"},Se={class:"flex"},je={class:"col-span-full"},qe=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"confirm-password"},"Poste",-1),He={class:"relative shadow-sm rounded-md mt-2"},Ie={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Qe={class:"col-span-full"},Te=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"confirm-password"},"College",-1),Je={class:"relative shadow-sm rounded-md mt-2"},We={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Xe={class:"sm:col-span-3"},Ze=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"first-name"},"Matricule",-1),Ke={class:"relative shadow-sm rounded-md mt-2"},es={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},ss={class:"sm:col-span-3"},ts=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"last-name"},"Centre de Responsabilité",-1),as={class:"relative shadow-sm rounded-md mt-2"},ls={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},rs={class:"sm:col-span-3"},os=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"first-name"},"GF",-1),is={class:"relative shadow-sm rounded-md mt-2"},ns={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},ds={class:"sm:col-span-3"},us=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"last-name"},"NR",-1),ms={class:"relative shadow-sm rounded-md mt-2"},cs={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},_s={class:"sm:col-span-3"},gs=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"first-name"},"Date Promotion GF",-1),fs={class:"relative shadow-sm rounded-md mt-2"},ps=["value"],hs={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},xs={class:"sm:col-span-3"},ys=e("label",{class:"block text-sm font-medium leading-6 text-gray-900",for:"last-name"},"Date Promotion NR",-1),vs={class:"relative shadow-sm rounded-md mt-2"},bs=["value"],ws={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3"},Vs={key:0,class:"sm:col-span-4"},ks={class:"mt-2"},Cs={class:"relative mt-2"},Us={class:"block truncate"},Ns={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"},Ds={class:"col-span-full"},Ms={class:"relative mt-2"},Ys={class:"flex"},Ls={class:"mt-8 flex"},Is={__name:"Profile",props:{user:{type:Object},n1s:{type:Array},orgs:{type:Array},roles:{type:Array}},setup(p){const r=p,F=X(()=>Z().props.auth.user.role_id===1),Q=[{name:"Profil",href:"#",current:!0}],g=O(F?{n1_id:r.user.n1?r.user.n1.user_id:-1,org_id:r.user.org?r.user.org.org_id:null,role_id:r.user.role.role_id}:{n1_id:r.user.n1?r.user.n1.user_id:-1,org_id:r.user.org?r.user.org.org_id:null}),D=r.orgs,k=U(""),v=U(D),$=z({keyword:"",fields:["org_name","org_responsibility_center"]}),M=r.n1s,C=U(""),b=U(M),B=z({keyword:"",fields:["user_matricule","user_display_name"]}),o=(()=>O(ae(r.user)?{}:{user_first_name:r.user.user_first_name||"",user_last_name:r.user.user_last_name||"",email:r.user.email||"",org_name:r.user.org?r.user.org.org_name:"",user_title:r.user.user_title||"",user_matricule:r.user.user_matricule||"",group_name:r.user.group?r.user.group.group_name:"",user_responsibility_center:r.user.user_responsibility_center||"",user_gf:r.user.user_gf||"",user_nr:r.user.user_nr||"",user_gf_prom_date:r.user.user_gf_prom_date||"",user_nr_prom_date:r.user.user_nr_prom_date||""}))(),T=()=>g.put(route("profile.update",{profile:r.user.user_id})),J=()=>axios.post(route("users.search"),B),W=()=>axios.post(route("orgs.search"),$);return E(()=>C.value,function(h){let l=h===""?M:M.filter(t=>t.user_matricule.toLowerCase().includes(C.value.toLowerCase())||t.user_display_name.toLowerCase().includes(C.value.toLowerCase()));l.length>0?b.value=l:h.length>=3&&J().then(t=>b.value=t.data)}),E(()=>k.value,function(h){let l=h===""?D:D.filter(t=>t.org_name.toLowerCase().includes(k.value.toLowerCase())||t.org_responsibility_center.toLowerCase().includes(k.value.toLowerCase()));l.length>0?v.value=l:h.length>=3&&W().then(t=>v.value=t.data)}),(h,l)=>(d(),x(te,null,{default:i(()=>[a(s(K),{title:"Profil"}),e("div",me,[a(le,{pages:Q}),e("div",ce,[e("div",_e,[e("h1",ge,"Profil de "+w(p.user.user_display_name),1),fe])]),e("div",pe,[e("div",he,[xe,e("form",ye,[e("div",ve,[be,e("div",we,[Ve,e("div",ke,[a(_,{modelValue:s(o).user_first_name,"onUpdate:modelValue":l[0]||(l[0]=t=>s(o).user_first_name=t),disabled:!0},null,8,["modelValue"]),e("div",Ce,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",Ue,[Ne,e("div",De,[a(_,{modelValue:s(o).user_last_name,"onUpdate:modelValue":l[1]||(l[1]=t=>s(o).user_last_name=t),disabled:!0},null,8,["modelValue"]),e("div",Me,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",Ye,[Le,e("div",Pe,[a(_,{modelValue:s(o).email,"onUpdate:modelValue":l[2]||(l[2]=t=>s(o).email=t),disabled:!0},null,8,["modelValue"]),e("div",Fe,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])])]),e("div",$e,[e("button",Be,[V(" Enregistrer "),a(s(N),{class:"text-white -mr-0.5 h-5 w-5"})])])])]),e("div",Oe,[ze,e("form",{class:"md:col-span-2",onSubmit:ee(T,["prevent"])},[e("div",Re,[e("div",Ae,[a(s(H),{modelValue:s(g).org_id,"onUpdate:modelValue":l[4]||(l[4]=t=>s(g).org_id=t),as:"div"},{default:i(()=>[a(s(G),{class:"block text-sm font-medium leading-6 text-gray-900"},{default:i(()=>[V("Organisation")]),_:1}),e("div",Ge,[a(s(S),{"display-value":t=>{let n=v.value.filter(u=>u.org_id===t)[0]||p.user.org;return n?n.org_name+" "+n.org_responsibility_center:"Non défini"},class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-12 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-cyan-600 sm:text-sm sm:leading-6",onChange:l[3]||(l[3]=t=>{$.keyword=k.value=t.target.value})},null,8,["display-value"]),a(s(j),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:i(()=>[a(s(P),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})]),_:1}),v.value.length>0?(d(),x(s(q),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:i(()=>[(d(!0),f(L,null,Y(v.value,t=>(d(),x(s(I),{key:t.org_id,value:t.org_id,as:"template"},{default:i(({active:n,selected:u})=>[e("li",{class:c(["relative cursor-default select-none py-2 pl-3 pr-9",n?"bg-cyan-600 text-white":"text-gray-900"])},[e("div",Se,[e("span",{class:c(["truncate",u&&"font-semibold"])},w((t==null?void 0:t.org_name)+" --> "+(t==null?void 0:t.org_responsibility_center)),3)]),u?(d(),f("span",{key:0,class:c(["absolute inset-y-0 right-0 flex items-center pr-4",n?"text-white":"text-cyan-600"])},[a(s(N),{"aria-hidden":"true",class:"h-5 w-5"})],2)):y("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):y("",!0)])]),_:1},8,["modelValue"])]),e("div",je,[qe,e("div",He,[a(_,{modelValue:s(o).user_title,"onUpdate:modelValue":l[5]||(l[5]=t=>s(o).user_title=t),disabled:!0},null,8,["modelValue"]),e("div",Ie,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",Qe,[Te,e("div",Je,[a(_,{modelValue:s(o).group_name,"onUpdate:modelValue":l[6]||(l[6]=t=>s(o).group_name=t),disabled:!0},null,8,["modelValue"]),e("div",We,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",Xe,[Ze,e("div",Ke,[a(_,{modelValue:s(o).user_matricule,"onUpdate:modelValue":l[7]||(l[7]=t=>s(o).user_matricule=t),disabled:!0},null,8,["modelValue"]),e("div",es,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",ss,[ts,e("div",as,[a(_,{modelValue:s(o).user_responsibility_center,"onUpdate:modelValue":l[8]||(l[8]=t=>s(o).user_responsibility_center=t),disabled:!0},null,8,["modelValue"]),e("div",ls,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",rs,[os,e("div",is,[a(_,{modelValue:s(o).user_gf,"onUpdate:modelValue":l[9]||(l[9]=t=>s(o).user_gf=t),disabled:!0},null,8,["modelValue"]),e("div",ns,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",ds,[us,e("div",ms,[a(_,{modelValue:s(o).user_nr,"onUpdate:modelValue":l[10]||(l[10]=t=>s(o).user_nr=t),disabled:!0},null,8,["modelValue"]),e("div",cs,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",_s,[gs,e("div",fs,[e("input",{disabled:!0,value:s(R)(s(A)(s(o).user_gf_prom_date).format("DD MMMM YYYY")),class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"},null,8,ps),e("div",hs,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),e("div",xs,[ys,e("div",vs,[e("input",{disabled:!0,value:s(R)(s(A)(s(o).user_nr_prom_date).format("DD MMMM YYYY")),class:"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset sm:text-sm sm:leading-6"},null,8,bs),e("div",ws,[a(s(m),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])])]),F.value?(d(),f("div",Vs,[a(oe,null,{default:i(()=>[V("Role")]),_:1}),e("div",ks,[a(s(de),{modelValue:s(g).role_id,"onUpdate:modelValue":l[11]||(l[11]=t=>s(g).role_id=t),as:"div"},{default:i(()=>[e("div",Cs,[a(s(ie),{class:"relative w-full cursor-default rounded-md bg-white py-1.5 pl-3 pr-10 text-left text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:outline-none focus:ring-2 focus:ring-cyan-600 sm:text-sm sm:leading-6"},{default:i(()=>[e("span",Us,w(p.roles.filter(t=>t.role_id===s(g).role_id)[0].role_name),1),e("span",Ns,[a(s(P),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])]),_:1}),a(se,{"leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:i(()=>[a(s(ne),{class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:i(()=>[(d(!0),f(L,null,Y(p.roles,t=>(d(),x(s(ue),{key:t.role_id,value:t.role_id,as:"template"},{default:i(({active:n,selected:u})=>[e("li",{class:c([n?"bg-cyan-600 text-white":"text-gray-900","relative cursor-default select-none py-2 pl-3 pr-9"])},[e("span",{class:c([u?"font-semibold":"font-normal","block truncate"])},w(t.role_name),3),u?(d(),f("span",{key:0,class:c([n?"text-white":"text-cyan-600","absolute inset-y-0 right-0 flex items-center pr-4"])},[a(s(N),{"aria-hidden":"true",class:"h-5 w-5"})],2)):y("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})]),_:1})])]),_:1},8,["modelValue"])])])):y("",!0),e("div",Ds,[a(s(H),{modelValue:s(g).n1_id,"onUpdate:modelValue":l[13]||(l[13]=t=>s(g).n1_id=t),as:"div"},{default:i(()=>[a(s(G),{class:"block text-sm font-medium leading-6 text-gray-900"},{default:i(()=>[V("Supérieure Hiérarchique (N + 1)")]),_:1}),e("div",Ms,[a(s(S),{"display-value":t=>{let n=b.value.filter(u=>u.user_id===t)[0]||p.user.n1;return n?n.user_matricule+" "+n.user_display_name:"Non défini"},class:"w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-12 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-cyan-600 sm:text-sm sm:leading-6",onChange:l[12]||(l[12]=t=>{B.keyword=C.value=t.target.value})},null,8,["display-value"]),a(s(j),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:i(()=>[a(s(P),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})]),_:1}),b.value.length>0?(d(),x(s(q),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:i(()=>[(d(!0),f(L,null,Y(b.value,t=>(d(),x(s(I),{key:t.user_id,value:t.user_id,as:"template"},{default:i(({active:n,selected:u})=>[e("li",{class:c(["relative cursor-default select-none py-2 pl-3 pr-9",n?"bg-cyan-600 text-white":"text-gray-900"])},[e("div",Ys,[e("span",{class:c(["truncate",u&&"font-semibold"])},w((t==null?void 0:t.user_matricule)+" "+(t==null?void 0:t.user_display_name)),3)]),u?(d(),f("span",{key:0,class:c(["absolute inset-y-0 right-0 flex items-center pr-4",n?"text-white":"text-cyan-600"])},[a(s(N),{"aria-hidden":"true",class:"h-5 w-5"})],2)):y("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):y("",!0)])]),_:1},8,["modelValue"])])]),e("div",Ls,[a(re,null,{default:i(()=>[V(" Enregistrer")]),_:1})])],40,Ee)])])])]),_:1}))}};export{Is as default};
