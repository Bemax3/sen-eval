import{_ as O}from"./AuthenticatedLayout-a2654eb8.js";import{Q as P,b as x,r as g,w as S,o as l,d as w,e as n,f as e,u as m,Z as T,a as o,c,g as u,k as V,F as U,j as Q,t as b,O as D}from"./app-589b6ab5.js";import{_ as R,a as Z}from"./Title-96585be5.js";import{_ as q}from"./Breadcrumbs-65bf6fa9.js";import{g as z,a as G}from"./helper-9d93711f.js";import{_ as H}from"./Datatable-9e7bd542.js";import{r as I,_,a as y,b as J}from"./EmptyState-fbc63e87.js";import{_ as K}from"./DeleteModal-34227f27.js";import{_ as W}from"./SectionTitle-30281add.js";import X from"./SaveMobilityModal-d3d87cb4.js";import{r as Y}from"./PencilSquareIcon-b18d63ca.js";import{r as ee}from"./TrashIcon-7c87b86a.js";import"./logo1637145113-c7398df9.js";import"./ExclamationTriangleIcon-6343b611.js";import"./InputLabel-abf86e56.js";import"./InputError-9ab85800.js";import"./TextArea-c847ba0a.js";import"./FormIndications-9edc05da.js";import"./SubmitButton-c6a61157.js";import"./CheckIcon-c0a2e6bc.js";import"./TextInput-9778b1d8.js";import"./ChevronUpDownIcon-b285a6e4.js";import"./CheckIcon-0a83d745.js";import"./listbox-8a5adbf0.js";import"./use-controllable-17c4dbac.js";const te={class:"px-4 sm:px-6 lg:px-8"},ae={class:"sm:flex sm:items-center border-b border-gray-400 pb-5 mt-8"},ie={key:0,class:"space-x-2 mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},se={key:0,class:"min-w-full divide-y divide-gray-300 dark:divide-black"},ne={class:"bg-gray-50 dark:bg-grayish"},re={class:"divide-y divide-gray-200 dark:divide-black bg-white dark:bg-grayish"},le={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},oe={key:0,class:"flex items-center justify-center space-x-2"},ue=["onClick"],de=["onClick"],me={key:1,class:"text-center bg-white dark:bg-grayish text-lg text-gray-600 py-4"},E="",Pe={__name:"RatingMobilities",props:{agent:{},rating:{},types:{type:Array},mobilities:{}},setup(r){var M;const a=r,f=P().props.auth.user,$=x(()=>f.user_id===a.rating.evaluated_id),v=x(()=>f.user_id!==a.rating.evaluated_id&&f.user_id!==a.rating.evaluator_id),N=$.value?[{name:"Mes Évaluations",href:route("ratings.index",{agent_rating:a.rating.rating_id}),current:!1},{name:"Evaluation",href:"#",current:!0}]:v?[{name:"Mes validations",href:route("validations.index"),current:!1},{name:"Évaluation",href:"#",current:!0}]:[{name:"Mes Agents",href:route("agents.index"),current:!1},{name:"Évaluations",href:route("agent-ratings.index",{agent:a.agent.user_id}),current:!1},{name:"Evaluation",href:"#",current:!0}],A=x(()=>z(a.mobilities)),d=g(a.mobilities.data),p=g(!1),h=g(!1),k=g((M=d[0])==null?void 0:M.rating_mobility_id),C=g(d[0]),B=i=>{k.value=i,h.value=!0},j=i=>{C.value=d.value.filter(s=>s.rating_mobility_id===i)[0],p.value=!0},F=()=>{p.value=!0};return S(()=>a.mobilities,function(i){d.value=i.data,!d.value.length>0&&(i.prev_page_url?D.get(i.prev_page_url):D.get(i.first_page_url))}),(i,s)=>(l(),w(O,null,{default:n(()=>[e(m(T),{title:"Mobilités"}),o("div",te,[e(q,{pages:m(N)},null,8,["pages"]),e(R,{agent:r.agent,rating:r.rating},null,8,["agent","rating"]),e(Z,{agent_id:a.agent.user_id,evaluated:$.value,rating_id:a.rating.rating_id,validator:v.value},null,8,["agent_id","evaluated","rating_id","validator"]),o("div",ae,[e(W,{desc:"Liste des mobilités demandées pour cette évaluation",title:"Mobilités"}),!v.value&&!r.rating.rating_is_validated?(l(),c("div",ie,[o("button",{class:"inline-flex gap-x-1.5 rounded-md bg-cyan-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",onClick:s[0]||(s[0]=t=>F())},[u(" Nouvelle Mobilité "),e(m(I),{class:"-mr-0.5 h-5 w-5"})])])):V("",!0)]),m(G)(r.mobilities.data)?(l(),w(H,{key:0,modelValue:E,"onUpdate:modelValue":s[1]||(s[1]=t=>E=t),pagination:A.value,search:!1},{default:n(()=>[d.value.length>0?(l(),c("table",se,[o("thead",ne,[o("tr",null,[e(_,{first:!0},{default:n(()=>[u("Nature")]),_:1}),e(_,null,{default:n(()=>[u("Demandée par")]),_:1}),e(_,null,{default:n(()=>[u("Poste demandé")]),_:1}),e(_,{class:"whitespace-pre-line"},{default:n(()=>[u("Commentaire")]),_:1}),e(_)])]),o("tbody",re,[(l(!0),c(U,null,Q(d.value,t=>(l(),c("tr",{key:t.rating_mobility_id},[e(y,{first:!0,class:"whitespace-pre-line"},{default:n(()=>[u(b(t.type.mobility_type_name),1)]),_:2},1024),e(y,null,{default:n(()=>[u(b(t.asked_by?t.asked_by.user_display_name:"Unknown"),1)]),_:2},1024),e(y,null,{default:n(()=>[u(b(t.rating_mobility_title),1)]),_:2},1024),e(y,{class:"whitespace-pre-line"},{default:n(()=>[u(b(t.rating_mobility_comment),1)]),_:2},1024),o("td",le,[!r.rating.rating_is_validated&&t.asked_by&&m(f).user_id===t.asked_by.user_id?(l(),c("div",oe,[o("button",{class:"rounded-lg bg-cyan-600 p-2 text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",type:"button",onClick:L=>j(t.rating_mobility_id)},[e(m(Y),{"aria-hidden":"true",class:"h-5 w-5"})],8,ue),o("button",{class:"rounded-lg bg-red-600 p-2 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",type:"button",onClick:L=>B(t.rating_mobility_id)},[e(m(ee),{"aria-hidden":"true",class:"h-5 w-5"})],8,de)])):V("",!0)])]))),128))])])):(l(),c("div",me," Aucun élément trouvé."))]),_:1},8,["pagination"])):(l(),w(J,{key:1,message:"Demander une mobilité en utilisant le formulaire en haut.",title:"Aucune mobilité demandée pour l'instant."}))]),e(K,{link:i.route("rating-mobilities.destroy",{rating:r.rating.rating_id,rating_mobility:k.value?k.value:-1}),opened:h.value,onCloseModal:s[2]||(s[2]=t=>h.value=!1)},null,8,["link","opened"]),e(X,{isValidator:v.value,mobility:C.value,opened:p.value,rating:r.rating,types:r.types,onCloseModal:s[3]||(s[3]=t=>p.value=!1)},null,8,["isValidator","mobility","opened","rating","types"])]),_:1}))}};export{Pe as default};
