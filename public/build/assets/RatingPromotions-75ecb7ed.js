import{_ as O}from"./AuthenticatedLayout-b0b54744.js";import{Q as S,b as w,r as v,w as T,o as l,d as $,e as a,f as e,u as g,Z as z,a as n,c,g as d,k as V,F as Q,j as R,t as _,n as E,O as N}from"./app-c51809d2.js";import{_ as U,a as Z}from"./Title-3522fcb7.js";import{_ as q}from"./Breadcrumbs-6cd41b84.js";import{g as G,a as H}from"./helper-f88ff6de.js";import{_ as I}from"./Datatable-33676cac.js";import{r as J,_ as p,a as b,b as K}from"./EmptyState-ab9bb41f.js";import{_ as W}from"./DeleteModal-51cbe796.js";import{_ as X}from"./SectionTitle-bd985838.js";import Y from"./SavePromotionModal-476cad4e.js";import{r as ee}from"./PencilSquareIcon-5c661c37.js";import{r as te}from"./TrashIcon-b4cb54e4.js";import"./logo1637145113-c7398df9.js";import"./ExclamationTriangleIcon-a9712964.js";import"./InputLabel-be02b7d5.js";import"./InputError-9650500a.js";import"./TextArea-99af695b.js";import"./FormIndications-38155857.js";import"./SubmitButton-42dd88ba.js";import"./CheckIcon-37fba7ec.js";import"./Switch-4e7456cc.js";import"./switch-0def0acf.js";import"./use-controllable-abfeee94.js";import"./ChevronUpDownIcon-f3f22d97.js";import"./CheckIcon-64bcec63.js";import"./listbox-91d0ad42.js";const ae={class:"px-4 sm:px-6 lg:px-8"},ie={class:"sm:flex sm:items-center border-b border-gray-400 pb-5 mt-8"},ne={key:0,class:"space-x-2 mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},re={key:0,class:"min-w-full divide-y divide-gray-300 dark:divide-black"},se={class:"bg-gray-50 dark:bg-grayish"},oe={class:"divide-y divide-gray-200 dark:divide-black bg-white dark:bg-grayish"},le={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},de={key:0,class:"flex items-center justify-center gap-2"},ue=["onClick"],me=["onClick"],ge={key:1,class:"text-center bg-white dark:bg-grayish text-lg text-gray-600 py-4"},D="",Te={__name:"RatingPromotions",props:{agent:{},rating:{},types:{type:Array},promotions:{}},setup(i){var P;const r=i,y=S().props.auth.user,m=w(()=>y.user_id===r.rating.evaluated_id),f=w(()=>y.user_id!==r.rating.evaluated_id&&y.user_id!==r.rating.evaluator_id),M=m.value?[{name:"Mes Évaluations",href:route("ratings.index",{agent_rating:r.rating.rating_id}),current:!1},{name:"Evaluation",href:"#",current:!0}]:f?[{name:"Mes validations",href:route("validations.index"),current:!1},{name:"Évaluation",href:"#",current:!0}]:[{name:"Mes Agents",href:route("agents.index"),current:!1},{name:"Évaluations",href:route("agent-ratings.index",{agent:r.agent.user_id}),current:!1},{name:"Evaluation",href:"#",current:!0}],A=w(()=>G(r.promotions)),u=v(r.promotions.data),x=v(!1),h=v(!1),k=v((P=u[0])==null?void 0:P.rating_mobility_id),C=v(u[0]),B=s=>{k.value=s,x.value=!0},j=s=>{C.value=u.value.filter(o=>o.rating_promotion_id===s)[0],h.value=!0},F=()=>{h.value=!0};return T(()=>r.promotions,function(s){u.value=s.data,!u.value.length>0&&(s.prev_page_url?N.get(s.prev_page_url):N.get(s.first_page_url))}),(s,o)=>(l(),$(O,null,{default:a(()=>[e(g(z),{title:"Promotion"}),n("div",ae,[e(q,{pages:g(M)},null,8,["pages"]),e(U,{agent:i.agent,rating:i.rating},null,8,["agent","rating"]),e(Z,{agent_id:r.agent.user_id,evaluated:m.value,rating_id:r.rating.rating_id,validator:f.value},null,8,["agent_id","evaluated","rating_id","validator"]),n("div",ie,[e(X,{desc:"Liste des promotions demandées pour cette évaluation",title:"Promotions"}),!m.value&&!f.value&&!i.rating.rating_is_validated?(l(),c("div",ne,[n("button",{class:"inline-flex gap-x-1.5 rounded-md bg-cyan-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",onClick:o[0]||(o[0]=t=>F())},[d(" Nouvelle Promotion "),e(g(J),{class:"-mr-0.5 h-5 w-5"})])])):V("",!0)]),g(H)(i.promotions.data)?(l(),$(I,{key:0,modelValue:D,"onUpdate:modelValue":o[1]||(o[1]=t=>D=t),pagination:A.value,search:!1},{default:a(()=>[u.value.length>0?(l(),c("table",re,[n("thead",se,[n("tr",null,[e(p,{first:!0},{default:a(()=>[d("Nature")]),_:1}),e(p,null,{default:a(()=>[d("Demandée par")]),_:1}),e(p,null,{default:a(()=>[d("Éligibilité")]),_:1}),e(p,null,{default:a(()=>[d("Proposition")]),_:1}),e(p,{class:"whitespace-pre-line"},{default:a(()=>[d("Commentaire")]),_:1}),e(p)])]),n("tbody",oe,[(l(!0),c(Q,null,R(u.value,t=>(l(),c("tr",{key:t.rating_promotion_id},[e(b,{first:!0,class:"whitespace-pre-line"},{default:a(()=>[d(_(t.type.promotion_type_name),1)]),_:2},1024),e(b,null,{default:a(()=>[d(_(i.rating.evaluator.user_display_name),1)]),_:1}),e(b,null,{default:a(()=>[n("span",{class:E([t.evaluated_is_eligible?"bg-green-50 text-green-700 ring-green-600/20 dark:bg-green-600 dark:text-white":"bg-red-50 text-red-700 ring-red-600/20 dark:bg-red-600 dark:text-white","inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset"])},_(t.evaluated_is_eligible?"Éligible":"Non Éligible"),3)]),_:2},1024),e(b,null,{default:a(()=>[n("span",{class:E([t.is_proposed?"bg-green-50 text-green-700 ring-green-600/20 dark:bg-green-600 dark:text-white":"bg-red-50 text-red-700 ring-red-600/20 dark:bg-red-600 dark:text-white","inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset"])},_(t.is_proposed?"Proposé":"Non Proposé"),3)]),_:2},1024),e(b,{class:"whitespace-pre-line"},{default:a(()=>[d(_(t.rating_promotion_comment),1)]),_:2},1024),n("td",le,[!m.value&&!f.value&&!i.rating.rating_is_validated?(l(),c("div",de,[n("button",{class:"rounded-lg bg-cyan-600 p-2 text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",type:"button",onClick:L=>j(t.rating_promotion_id)},[e(g(ee),{"aria-hidden":"true",class:"h-5 w-5"})],8,ue),n("button",{class:"rounded-lg bg-red-600 p-2 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",type:"button",onClick:L=>B(t.rating_promotion_id)},[e(g(te),{"aria-hidden":"true",class:"h-5 w-5"})],8,me)])):V("",!0)])]))),128))])])):(l(),c("div",ge," Aucun élément trouvé."))]),_:1},8,["pagination"])):(l(),$(K,{key:1,message:m.value?"":"Demander une promotion en utilisant le formulaire en haut.",title:"Aucune promotions ou avancement demandée pour l'instant."},null,8,["message"]))]),e(W,{link:s.route("rating-promotions.destroy",{rating:i.rating.rating_id,rating_promotion:k.value?k.value:-1}),opened:x.value,onCloseModal:o[2]||(o[2]=t=>x.value=!1)},null,8,["link","opened"]),e(Y,{agent:i.agent,isEvaluated:m.value,isValidator:f.value,opened:h.value,promotion:C.value,rating:i.rating,types:i.types,onCloseModal:o[3]||(o[3]=t=>h.value=!1)},null,8,["agent","isEvaluated","isValidator","opened","promotion","rating","types"])]),_:1}))}};export{Te as default};
