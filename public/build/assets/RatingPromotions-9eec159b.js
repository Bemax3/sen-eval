import{_ as L}from"./AuthenticatedLayout-94538ec7.js";import{Q as O,b as k,r as p,w as S,o as l,d as $,e as o,f as e,u as g,Z as T,a as r,c,g as u,k as E,F as z,j as Q,O as D,t as b,n as R}from"./app-c4f187be.js";import{_ as U,a as Z}from"./Title-ceb487f9.js";import{_ as q}from"./Breadcrumbs-407b3470.js";import{g as G,a as H}from"./helper-c9a85e48.js";import{_ as I}from"./Datatable-16a2f7dd.js";import{r as J,_ as v,a as K,b as y}from"./EmptyState-c0c5d7a2.js";import{_ as W}from"./DeleteModal-50fb4bdd.js";import{_ as X}from"./SectionTitle-4e9cfd73.js";import Y from"./SavePromotionModal-e67082eb.js";import{r as ee}from"./PencilSquareIcon-cd3a3f2f.js";import{r as te}from"./TrashIcon-945dd6a4.js";import"./logo1637145113-c7398df9.js";import"./ExclamationTriangleIcon-5f0591a6.js";import"./InputLabel-9c315d9e.js";import"./InputError-90ce686a.js";import"./TextArea-d4be9570.js";import"./FormIndications-abfac2c3.js";import"./SubmitButton-a9fe8e59.js";import"./CheckIcon-8d9f9564.js";import"./Switch-961abc10.js";import"./switch-6b92d620.js";import"./use-controllable-186a6d72.js";import"./ChevronUpDownIcon-b3e6edea.js";import"./CheckIcon-bcd955be.js";import"./listbox-6e1bf4ed.js";const ae={class:"px-4 sm:px-6 lg:px-8"},ie={class:"sm:flex sm:items-center border-b border-gray-400 pb-5 mt-8"},ne={key:0,class:"space-x-2 mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},se={key:0,class:"min-w-full divide-y divide-gray-300"},oe={class:"bg-gray-50"},re={class:"divide-y divide-gray-200 bg-white"},le={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},ue={key:0,class:"flex items-center justify-center gap-2"},de=["onClick"],me=["onClick"],ge={key:1,class:"text-center bg-white text-lg text-gray-600 py-4"},N="",Te={__name:"RatingPromotions",props:{agent:{},rating:{},types:{type:Array},promotions:{}},setup(a){var V;const i=a,h=O().props.auth.user,m=k(()=>h.user_id===i.rating.evaluated_id),f=k(()=>h.user_id!==i.rating.evaluated_id&&h.user_id!==i.rating.evaluator_id),P=m.value?[{name:"Mes Évaluations",href:route("ratings.index",{agent_rating:i.rating.rating_id}),current:!1},{name:"Evaluation",href:"#",current:!0}]:f?[{name:"Mes validations",href:route("validations.index"),current:!1},{name:"Évaluation",href:"#",current:!0}]:[{name:"Mes Agents",href:route("agents.index"),current:!1},{name:"Évaluations",href:route("agent-ratings.index",{agent:i.agent.user_id}),current:!1},{name:"Evaluation",href:"#",current:!0}],M=k(()=>G(i.promotions)),d=p(i.promotions.data),x=p(!1),_=p(!1),w=p((V=d[0])==null?void 0:V.rating_mobility_id),C=p(d[0]),A=n=>{w.value=n,x.value=!0},B=n=>{C.value=d.value.filter(s=>s.rating_promotion_id===n)[0],_.value=!0},j=()=>{_.value=!0};return S(()=>i.promotions,function(n){d.value=n.data,!d.value.length>0&&(n.prev_page_url?D.get(n.prev_page_url):D.get(n.first_page_url))}),(n,s)=>(l(),$(L,null,{default:o(()=>[e(g(T),{title:"Promotion"}),r("div",ae,[e(q,{pages:g(P)},null,8,["pages"]),e(U,{agent:a.agent,rating:a.rating},null,8,["agent","rating"]),e(Z,{agent_id:i.agent.user_id,evaluated:m.value,rating_id:i.rating.rating_id,validator:f.value},null,8,["agent_id","evaluated","rating_id","validator"]),r("div",ie,[e(X,{desc:"Liste des promotions demandées pour cette évaluation",title:"Promotions"}),!m.value&&!f.value&&!a.rating.rating_is_validated?(l(),c("div",ne,[r("button",{class:"inline-flex gap-x-1.5 rounded-md bg-cyan-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",onClick:s[0]||(s[0]=t=>j())},[u(" Nouvelle Promotion "),e(g(J),{class:"-mr-0.5 h-5 w-5"})])])):E("",!0)]),g(H)(a.promotions.data)?(l(),$(I,{key:0,modelValue:N,"onUpdate:modelValue":s[1]||(s[1]=t=>N=t),pagination:M.value,search:!1},{default:o(()=>[d.value.length>0?(l(),c("table",se,[r("thead",oe,[r("tr",null,[e(v,{first:!0},{default:o(()=>[u("Nature")]),_:1}),e(v,null,{default:o(()=>[u("Demandée par")]),_:1}),e(v,null,{default:o(()=>[u("Éligibilité")]),_:1}),e(v,{class:"whitespace-pre-line"},{default:o(()=>[u("Commentaire")]),_:1}),e(v)])]),r("tbody",re,[(l(!0),c(z,null,Q(d.value,t=>(l(),c("tr",{key:t.rating_promotion_id},[e(y,{first:!0,class:"whitespace-pre-line"},{default:o(()=>[u(b(t.type.promotion_type_name),1)]),_:2},1024),e(y,null,{default:o(()=>[u(b(a.rating.evaluator.user_display_name),1)]),_:1}),e(y,null,{default:o(()=>[r("span",{class:R([t.evaluated_is_eligible?"bg-green-50 text-green-700 ring-green-600/20":"bg-red-50 text-red-700 ring-red-600/20","inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ring-1 ring-inset"])},b(t.evaluated_is_eligible?"Éligible":"Non Éligible"),3)]),_:2},1024),e(y,{class:"whitespace-pre-line"},{default:o(()=>[u(b(t.rating_promotion_comment),1)]),_:2},1024),r("td",le,[!m.value&&!f.value&&!a.rating.rating_is_validated?(l(),c("div",ue,[r("button",{class:"rounded-lg bg-cyan-600 p-2 text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",type:"button",onClick:F=>B(t.rating_promotion_id)},[e(g(ee),{"aria-hidden":"true",class:"h-5 w-5"})],8,de),r("button",{class:"rounded-lg bg-red-600 p-2 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",type:"button",onClick:F=>A(t.rating_promotion_id)},[e(g(te),{"aria-hidden":"true",class:"h-5 w-5"})],8,me)])):E("",!0)])]))),128))])])):(l(),c("div",ge," Aucun élément trouvé."))]),_:1},8,["pagination"])):(l(),$(K,{key:1,message:m.value?"":"Demander une promotion en utilisant le formulaire en haut.",title:"Aucune promotions ou avancement demandée pour l'instant."},null,8,["message"]))]),e(W,{link:n.route("rating-promotions.destroy",{rating:a.rating.rating_id,rating_promotion:w.value?w.value:-1}),opened:x.value,onCloseModal:s[2]||(s[2]=t=>x.value=!1)},null,8,["link","opened"]),e(Y,{agent:a.agent,isEvaluated:m.value,isValidator:f.value,opened:_.value,promotion:C.value,rating:a.rating,types:a.types,onCloseModal:s[3]||(s[3]=t=>_.value=!1)},null,8,["agent","isEvaluated","isValidator","opened","promotion","rating","types"])]),_:1}))}};export{Te as default};
