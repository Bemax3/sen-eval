import{_ as F}from"./AuthenticatedLayout-a2654eb8.js";import{Q as L,b as k,r as f,w as O,o as r,d as x,e as l,f as e,u as m,Z as P,a as o,c as g,g as d,k as E,F as Q,j as R,t as w,O as D}from"./app-589b6ab5.js";import{_ as U,a as Z}from"./Title-96585be5.js";import{_ as q}from"./Breadcrumbs-65bf6fa9.js";import{g as z,a as G}from"./helper-9d93711f.js";import{_ as H}from"./Datatable-9e7bd542.js";import{r as I,_ as p,a as $,b as J}from"./EmptyState-fbc63e87.js";import{_ as K}from"./DeleteModal-34227f27.js";import W from"./SaveSanctionModal-8710223a.js";import{_ as X}from"./SectionTitle-30281add.js";import{r as Y}from"./PencilSquareIcon-b18d63ca.js";import{r as ee}from"./TrashIcon-7c87b86a.js";import"./logo1637145113-c7398df9.js";import"./ExclamationTriangleIcon-6343b611.js";import"./InputLabel-abf86e56.js";import"./InputError-9ab85800.js";import"./TextArea-c847ba0a.js";import"./FormIndications-9edc05da.js";import"./SubmitButton-c6a61157.js";import"./CheckIcon-c0a2e6bc.js";import"./ChevronUpDownIcon-b285a6e4.js";import"./CheckIcon-0a83d745.js";import"./listbox-8a5adbf0.js";import"./use-controllable-17c4dbac.js";const te={class:"px-4 sm:px-6 lg:px-8"},ae={class:"sm:flex sm:items-center border-b border-gray-400 pb-5 mt-8"},ne={key:0,class:"space-x-2 mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},ie={key:0,class:"min-w-full divide-y divide-gray-300 dark:divide-black"},se={class:"bg-gray-50 dark:bg-grayish"},re={class:"divide-y divide-gray-200 dark:divide-black bg-white dark:bg-grayish"},oe={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},le={key:0,class:"flex items-center justify-center gap-2"},ue=["onClick"],de=["onClick"],ce={key:1,class:"text-center bg-white dark:bg-grayish text-lg text-gray-600 py-4"},S="",Fe={__name:"RatingSanctions",props:{agent:{},rating:{},types:{type:Array},sanctions:{}},setup(t){var V;const a=t,h=L().props.auth.user,c=k(()=>h.user_id===a.rating.evaluated_id),v=k(()=>h.user_id!==a.rating.evaluated_id&&h.user_id!==a.rating.evaluator_id),M=c.value?[{name:"Mes Évaluations",href:route("ratings.index",{agent_rating:a.rating.rating_id}),current:!1},{name:"Evaluation",href:"#",current:!0}]:v?[{name:"Mes validations",href:route("validations.index"),current:!1},{name:"Évaluation",href:"#",current:!0}]:[{name:"Mes Agents",href:route("agents.index"),current:!1},{name:"Évaluations",href:route("agent-ratings.index",{agent:a.agent.user_id}),current:!1},{name:"Evaluation",href:"#",current:!0}],N=k(()=>z(a.sanctions)),u=f(a.sanctions.data),y=f(!1),_=f(!1),b=f((V=u[0])==null?void 0:V.rating_sanction_id),C=f(u[0]),A=n=>{b.value=n,y.value=!0},B=n=>{C.value=u.value.filter(i=>i.rating_sanction_id===n)[0],_.value=!0},T=()=>{_.value=!0};return O(()=>a.sanctions,function(n){u.value=n.data,!u.value.length>0&&(n.prev_page_url?D.get(n.prev_page_url):D.get(n.first_page_url))}),(n,i)=>(r(),x(F,null,{default:l(()=>[e(m(P),{title:"Sanctions"}),o("div",te,[e(q,{pages:m(M)},null,8,["pages"]),e(U,{agent:t.agent,rating:t.rating},null,8,["agent","rating"]),e(Z,{agent_id:a.agent.user_id,evaluated:c.value,rating_id:a.rating.rating_id,validator:v.value},null,8,["agent_id","evaluated","rating_id","validator"]),o("div",ae,[e(X,{desc:"Liste des sanctions demandées pour cette évaluation",title:"Sanctions"}),!c.value&&!v.value&&!t.rating.rating_is_validated?(r(),g("div",ne,[o("button",{class:"inline-flex gap-x-1.5 rounded-md bg-cyan-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",onClick:i[0]||(i[0]=s=>T())},[d(" Nouvelle Sanction "),e(m(I),{class:"-mr-0.5 h-5 w-5"})])])):E("",!0)]),m(G)(t.sanctions.data)?(r(),x(H,{key:0,modelValue:S,"onUpdate:modelValue":i[1]||(i[1]=s=>S=s),pagination:N.value,search:!1},{default:l(()=>[u.value.length>0?(r(),g("table",ie,[o("thead",se,[o("tr",null,[e(p,{first:!0},{default:l(()=>[d("Type")]),_:1}),e(p,null,{default:l(()=>[d("Demandée par")]),_:1}),e(p,null,{default:l(()=>[d("Commentaire")]),_:1}),e(p)])]),o("tbody",re,[(r(!0),g(Q,null,R(u.value,s=>(r(),g("tr",{key:s.rating_sanction_id},[e($,{first:!0,class:"whitespace-pre-line"},{default:l(()=>[d(w(s.type.sanction_type_name),1)]),_:2},1024),e($,null,{default:l(()=>[d(w(t.rating.evaluator.user_display_name),1)]),_:1}),e($,{class:"whitespace-pre-line"},{default:l(()=>[d(w(s.rating_sanction_comment||"__"),1)]),_:2},1024),o("td",oe,[!c.value&&!v.value&&!t.rating.rating_is_validated?(r(),g("div",le,[o("button",{class:"rounded-lg bg-cyan-600 p-2 text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",type:"button",onClick:j=>B(s.rating_sanction_id)},[e(m(Y),{"aria-hidden":"true",class:"h-5 w-5"})],8,ue),o("button",{class:"rounded-lg bg-red-600 p-2 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",type:"button",onClick:j=>A(s.rating_sanction_id)},[e(m(ee),{"aria-hidden":"true",class:"h-5 w-5"})],8,de)])):E("",!0)])]))),128))])])):(r(),g("div",ce," Aucun élément trouvé."))]),_:1},8,["pagination"])):(r(),x(J,{key:1,message:c.value?"":"Demander une sanction en utilisant la liste déroulante en haut.",title:"Aucune sanction demandée pour l'instant."},null,8,["message"]))]),e(K,{link:n.route("rating-sanctions.destroy",{rating:t.rating.rating_id,rating_sanction:b.value?b.value:-1}),opened:y.value,onCloseModal:i[2]||(i[2]=s=>y.value=!1)},null,8,["link","opened"]),e(W,{isEvaluated:c.value,isValidator:v.value,opened:_.value,rating:t.rating,sanction:C.value,types:t.types,onCloseModal:i[3]||(i[3]=s=>_.value=!1)},null,8,["isEvaluated","isValidator","opened","rating","sanction","types"])]),_:1}))}};export{Fe as default};
