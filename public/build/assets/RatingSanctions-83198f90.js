import{_ as T}from"./AuthenticatedLayout-e8ebc8e5.js";import{Q as j,b,r as c,w as F,o as r,d as k,e as u,f as e,u as g,Z as O,a as l,c as m,g as f,F as L,j as P,t as C,k as Q,O as V}from"./app-81706381.js";import{_ as R,a as U}from"./Title-4c8289fe.js";import{_ as Z}from"./Breadcrumbs-7a50f25d.js";import{g as q,a as z}from"./helper-df860a3e.js";import{_ as G}from"./Datatable-a7d326b7.js";import{_ as w,a as E,b as H}from"./EmptyState-cf46cf93.js";import{_ as I}from"./DeleteModal-598356fb.js";import J from"./SaveSanctionModal-75d21e4d.js";import{r as K}from"./PencilSquareIcon-0d356612.js";import{r as W}from"./TrashIcon-3f582d6d.js";import"./logo1637145113-c7398df9.js";import"./ExclamationTriangleIcon-b037a3b9.js";import"./InputLabel-f4db3ebe.js";import"./InputError-0137a0d7.js";import"./TextArea-ba8bc83b.js";import"./FormIndications-64031431.js";import"./SubmitButton-2eda4449.js";import"./CheckIcon-98be674a.js";import"./ChevronUpDownIcon-ee624a25.js";import"./CheckIcon-abb97c5a.js";import"./listbox-e3924e79.js";import"./use-controllable-476ed86c.js";const X={class:"px-4 sm:px-6 lg:px-8"},Y={key:0,class:"min-w-full divide-y divide-gray-300 dark:divide-black"},ee={class:"bg-gray-50 dark:bg-grayish"},te={class:"divide-y divide-gray-200 dark:divide-black bg-white dark:bg-grayish"},ae={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},ie={key:0,class:"flex items-center justify-center gap-2"},ne=["onClick"],se=["onClick"],re={key:1,class:"text-center bg-white dark:bg-grayish text-lg text-gray-600 py-4"},D="",Ae={__name:"RatingSanctions",props:{agent:{},rating:{},types:{type:Array},sanctions:{}},setup(n){var $;const t=n,v=j().props.auth.user,d=b(()=>v.user_id===t.rating.evaluated_id),_=b(()=>v.user_id!==t.rating.evaluated_id&&v.user_id!==t.rating.evaluator_id),M=d.value?[{name:"Mes Évaluations",href:route("ratings.index",{agent_rating:t.rating.rating_id}),current:!1},{name:"Evaluation",href:"#",current:!0}]:_?[{name:"Mes validations",href:route("validations.index"),current:!1},{name:"Évaluation",href:"#",current:!0}]:[{name:"Mes Agents",href:route("agents.index"),current:!1},{name:"Évaluations",href:route("agent-ratings.index",{agent:t.agent.user_id}),current:!1},{name:"Evaluation",href:"#",current:!0}],A=b(()=>q(t.sanctions)),o=c(t.sanctions.data),p=c(!1),h=c(!1),y=c(($=o[0])==null?void 0:$.rating_sanction_id),x=c(o[0]),B=a=>{y.value=a,p.value=!0},N=a=>{x.value=o.value.filter(s=>s.rating_sanction_id===a)[0],h.value=!0};return F(()=>t.sanctions,function(a){o.value=a.data,!o.value.length>0&&(a.prev_page_url?V.get(a.prev_page_url):V.get(a.first_page_url))}),(a,s)=>(r(),k(T,null,{default:u(()=>[e(g(O),{title:"Sanctions"}),l("div",X,[e(Z,{pages:g(M)},null,8,["pages"]),e(R,{agent:n.agent,rating:n.rating},null,8,["agent","rating"]),e(U,{agent_id:t.agent.user_id,evaluated:d.value,rating_id:t.rating.rating_id,validator:_.value},null,8,["agent_id","evaluated","rating_id","validator"]),g(z)(n.sanctions.data)?(r(),k(G,{key:0,modelValue:D,"onUpdate:modelValue":s[0]||(s[0]=i=>D=i),pagination:A.value,search:!1},{default:u(()=>[o.value.length>0?(r(),m("table",Y,[l("thead",ee,[l("tr",null,[e(w,{first:!0},{default:u(()=>[f("Type")]),_:1}),e(w,null,{default:u(()=>[f("Commentaire")]),_:1}),e(w)])]),l("tbody",te,[(r(!0),m(L,null,P(o.value,i=>(r(),m("tr",{key:i.rating_sanction_id},[e(E,{first:!0,class:"whitespace-pre-line"},{default:u(()=>[f(C(i.type.sanction_type_name),1)]),_:2},1024),e(E,{class:"whitespace-pre-line"},{default:u(()=>[f(C(i.rating_sanction_comment||"__"),1)]),_:2},1024),l("td",ae,[!d.value&&!_.value&&!n.rating.rating_is_validated?(r(),m("div",ie,[l("button",{class:"rounded-lg bg-cyan-600 p-2 text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",type:"button",onClick:S=>N(i.rating_sanction_id)},[e(g(K),{"aria-hidden":"true",class:"h-5 w-5"})],8,ne),l("button",{class:"rounded-lg bg-red-600 p-2 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",type:"button",onClick:S=>B(i.rating_sanction_id)},[e(g(W),{"aria-hidden":"true",class:"h-5 w-5"})],8,se)])):Q("",!0)])]))),128))])])):(r(),m("div",re," Aucun élément trouvé."))]),_:1},8,["pagination"])):(r(),k(H,{key:1,message:d.value?"":"Demander une sanction en utilisant la liste déroulante en haut.",title:"Aucune sanction demandée pour l'instant."},null,8,["message"]))]),e(I,{link:a.route("rating-sanctions.destroy",{rating:n.rating.rating_id,rating_sanction:y.value?y.value:-1}),opened:p.value,onCloseModal:s[1]||(s[1]=i=>p.value=!1)},null,8,["link","opened"]),e(J,{isEvaluated:d.value,isValidator:_.value,opened:h.value,rating:n.rating,sanction:x.value,types:n.types,onCloseModal:s[2]||(s[2]=i=>h.value=!1)},null,8,["isEvaluated","isValidator","opened","rating","sanction","types"])]),_:1}))}};export{Ae as default};
