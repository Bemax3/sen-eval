import{_ as F}from"./AuthenticatedLayout-a74cb3f1.js";import{Q as L,b as x,r as v,w as O,o,d as w,e as l,f as e,u as m,Z as P,a as r,c as g,g as d,k as E,F as Q,j as R,O as D,t as k}from"./app-2a089cf5.js";import{_ as U,a as Z}from"./Title-63b7f253.js";import{_ as q}from"./Breadcrumbs-6398e3e4.js";import{g as z,a as G}from"./helper-18252d35.js";import{_ as H}from"./Datatable-a92b7c7f.js";import{r as I,_ as p,a as J,b as $}from"./EmptyState-732ad0f2.js";import{_ as K}from"./DeleteModal-c2a3b491.js";import W from"./SaveSanctionModal-d6bec009.js";import{_ as X}from"./SectionTitle-0dc7701a.js";import{r as Y}from"./PencilSquareIcon-62c36d40.js";import{r as ee}from"./TrashIcon-18c9b9b2.js";import"./logo1637145113-c7398df9.js";import"./ExclamationTriangleIcon-42547667.js";import"./InputLabel-b11fe90f.js";import"./InputError-28730c1d.js";import"./TextArea-5cd6d66b.js";import"./FormIndications-17f37fff.js";import"./SubmitButton-4134ce53.js";import"./CheckIcon-4be47fd9.js";import"./ChevronUpDownIcon-dfef16cc.js";import"./CheckIcon-7d20fe28.js";import"./listbox-d34d1a30.js";import"./use-controllable-595812ac.js";const te={class:"px-4 sm:px-6 lg:px-8"},ae={class:"sm:flex sm:items-center border-b border-gray-400 pb-5 mt-8"},ne={key:0,class:"space-x-2 mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},ie={key:0,class:"min-w-full divide-y divide-gray-300"},se={class:"bg-gray-50"},oe={class:"divide-y divide-gray-200 bg-white"},re={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},le={key:0,class:"flex items-center justify-center gap-2"},ue=["onClick"],de=["onClick"],ce={key:1,class:"text-center bg-white text-lg text-gray-600 py-4"},S="",Fe={__name:"RatingSanctions",props:{agent:{},rating:{},types:{type:Array},sanctions:{}},setup(t){var V;const a=t,h=L().props.auth.user,c=x(()=>h.user_id===a.rating.evaluated_id),f=x(()=>h.user_id!==a.rating.evaluated_id&&h.user_id!==a.rating.evaluator_id),M=c.value?[{name:"Mes Évaluations",href:route("ratings.index",{agent_rating:a.rating.rating_id}),current:!1},{name:"Evaluation",href:"#",current:!0}]:f?[{name:"Mes validations",href:route("validations.index"),current:!1},{name:"Évaluation",href:"#",current:!0}]:[{name:"Mes Agents",href:route("agents.index"),current:!1},{name:"Évaluations",href:route("agent-ratings.index",{agent:a.agent.user_id}),current:!1},{name:"Evaluation",href:"#",current:!0}],N=x(()=>z(a.sanctions)),u=v(a.sanctions.data),y=v(!1),_=v(!1),b=v((V=u[0])==null?void 0:V.rating_sanction_id),C=v(u[0]),A=n=>{b.value=n,y.value=!0},B=n=>{C.value=u.value.filter(i=>i.rating_sanction_id===n)[0],_.value=!0},T=()=>{_.value=!0};return O(()=>a.sanctions,function(n){u.value=n.data,!u.value.length>0&&(n.prev_page_url?D.get(n.prev_page_url):D.get(n.first_page_url))}),(n,i)=>(o(),w(F,null,{default:l(()=>[e(m(P),{title:"Sanctions"}),r("div",te,[e(q,{pages:m(M)},null,8,["pages"]),e(U,{agent:t.agent,rating:t.rating},null,8,["agent","rating"]),e(Z,{agent_id:a.agent.user_id,evaluated:c.value,rating_id:a.rating.rating_id,validator:f.value},null,8,["agent_id","evaluated","rating_id","validator"]),r("div",ae,[e(X,{desc:"Liste des sanctions demandées pour cette évaluation",title:"Sanctions"}),!c.value&&!f.value&&!t.rating.rating_is_validated?(o(),g("div",ne,[r("button",{class:"inline-flex gap-x-1.5 rounded-md bg-cyan-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",onClick:i[0]||(i[0]=s=>T())},[d(" Nouvelle Sanction "),e(m(I),{class:"-mr-0.5 h-5 w-5"})])])):E("",!0)]),m(G)(t.sanctions.data)?(o(),w(H,{key:0,modelValue:S,"onUpdate:modelValue":i[1]||(i[1]=s=>S=s),pagination:N.value,search:!1},{default:l(()=>[u.value.length>0?(o(),g("table",ie,[r("thead",se,[r("tr",null,[e(p,{first:!0},{default:l(()=>[d("Type")]),_:1}),e(p,null,{default:l(()=>[d("Demandée par")]),_:1}),e(p,null,{default:l(()=>[d("Commentaire")]),_:1}),e(p)])]),r("tbody",oe,[(o(!0),g(Q,null,R(u.value,s=>(o(),g("tr",{key:s.rating_sanction_id},[e($,{first:!0,class:"whitespace-pre-line"},{default:l(()=>[d(k(s.type.sanction_type_name),1)]),_:2},1024),e($,null,{default:l(()=>[d(k(t.rating.evaluator.user_display_name),1)]),_:1}),e($,{class:"whitespace-pre-line"},{default:l(()=>[d(k(s.rating_sanction_comment||"__"),1)]),_:2},1024),r("td",re,[!c.value&&!f.value&&!t.rating.rating_is_validated?(o(),g("div",le,[r("button",{class:"rounded-lg bg-cyan-600 p-2 text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600",type:"button",onClick:j=>B(s.rating_sanction_id)},[e(m(Y),{"aria-hidden":"true",class:"h-5 w-5"})],8,ue),r("button",{class:"rounded-lg bg-red-600 p-2 text-white shadow-sm hover:bg-red-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",type:"button",onClick:j=>A(s.rating_sanction_id)},[e(m(ee),{"aria-hidden":"true",class:"h-5 w-5"})],8,de)])):E("",!0)])]))),128))])])):(o(),g("div",ce," Aucun élément trouvé."))]),_:1},8,["pagination"])):(o(),w(J,{key:1,message:c.value?"":"Demander une sanction en utilisant la liste déroulante en haut.",title:"Aucune sanction demandée pour l'instant."},null,8,["message"]))]),e(K,{link:n.route("rating-sanctions.destroy",{rating:t.rating.rating_id,rating_sanction:b.value?b.value:-1}),opened:y.value,onCloseModal:i[2]||(i[2]=s=>y.value=!1)},null,8,["link","opened"]),e(W,{isEvaluated:c.value,isValidator:f.value,opened:_.value,rating:t.rating,sanction:C.value,types:t.types,onCloseModal:i[3]||(i[3]=s=>_.value=!1)},null,8,["isEvaluated","isValidator","opened","rating","sanction","types"])]),_:1}))}};export{Fe as default};
