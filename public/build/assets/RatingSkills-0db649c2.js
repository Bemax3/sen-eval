import{Q as N,b as O,d as Q,T as J,r as $,w as P,o as i,e as _,f as u,g as a,u as l,Z as R,a as e,c as n,F as b,i as w,h as T,n as p,j as f,k as F,t as o,l as U}from"./app-8902e07e.js";import{_ as X,h as z}from"./AuthenticatedLayout-dacbcdc5.js";import{_ as Y}from"./Breadcrumbs-066f3f96.js";import{_ as Z}from"./FormIndications-26a748c1.js";import{_ as H}from"./SubmitButton-825b5714.js";import{_ as I,a as K}from"./Title-641ceb08.js";import{_ as v,a as W,b as ee}from"./ValidationWarning-c79d93dd.js";import{_ as V}from"./EmptyState-ad6b3eba.js";import{_ as te}from"./TextArea-6b4b847b.js";import{_ as se}from"./InputLabel-7282d2f5.js";import{_ as ae}from"./InputError-eeaee326.js";import{r as ie}from"./ChevronUpDownIcon-e1648cfe.js";import{r as B}from"./CheckIcon-e4635f0c.js";import{Q as le,G as re,X as ne,J as oe,Y as de}from"./combobox-9a078bf7.js";import"./logo1637145113-11387d37.js";import"./SimpleTable-f18d2a2a.js";import"./TableData-34a8100c.js";import"./ExclamationTriangleIcon-7445226b.js";import"./use-controllable-83b8ecc2.js";const ce={class:"px-4 sm:px-6 lg:px-8"},me={role:"list"},_e={class:"px-4 py-4 sm:px-0"},ue={key:0,class:"divide-y divide-gray-100",role:"list"},ge={class:"min-w-0"},pe={class:"flex items-start gap-x-3"},fe={class:"text-base font-bold leading-6 text-gray-900"},ve={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},xe={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},he={class:"whitespace-break-spaces"},ye={class:"flex flex-none items-center gap-x-4"},ke={class:"flex items-center justify-center space-x-4"},be={class:"ml-0.5 font-bold"},we={class:"px-4 py-4 sm:px-0"},je={class:"divide-y divide-gray-100",role:"list"},Ce={class:"min-w-0"},$e={class:"flex items-start gap-x-3"},Ve={class:"text-base font-bold leading-6 text-gray-900"},Se={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Le={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},qe={class:"whitespace-break-spaces"},Ne={class:"flex flex-none items-center gap-x-4"},Oe={class:"flex items-center justify-center space-x-4"},Te={class:"ml-0.5 font-bold"},Fe={class:"px-4 py-4 sm:px-0"},ze={key:0,class:"divide-y divide-gray-100",role:"list"},Be={class:"min-w-0"},Ee={class:"flex items-start gap-x-3"},Ae={class:"text-base font-bold leading-6 text-gray-900"},De={class:"text-white bg-gray-500 ring-gray-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Ge={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Me={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},Qe={class:"whitespace-break-spaces"},Je={class:"flex flex-none items-center gap-x-4"},Pe={class:"flex items-center justify-center space-x-4"},Re={class:"ml-0.5 font-bold"},Ue={class:"px-4 py-4 sm:px-0"},Xe={key:0},Ye={class:"px-4 py-4 sm:px-0"},Ze={class:"mt-8 bg-white shadow sm:rounded-lg"},He=["onSubmit"],Ie={class:"grid grid-cols-2 gap-2 sm:grid-cols-2"},Ke={class:"px-4 py-5 sm:p-6"},We=e("h3",{class:"text-base font-semibold leading-6 text-gray-900"},"Commentaire",-1),et=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500"},[e("p",null,"Ajouter un commentaire. ")],-1),tt={class:"mt-5 sm:flex sm:items-center"},st={class:"w-full sm:max-w-xl"},at={class:"col-span-full"},it={class:"mt-2"},lt={class:"px-4 py-5 sm:p-6"},rt=e("h3",{class:"text-base font-semibold leading-6 text-gray-900"},"Transférer",-1),nt=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500"},[e("p",null,"Transférer l'évaluation au supérieur hiérarchique. ")],-1),ot={class:"mt-6 w-full sm:max-w-xl"},dt={class:"relative"},ct={class:"flex"},mt={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},_t=["disabled"],Ot={__name:"RatingSkills",props:{rating:{type:Object},agent:{type:Object},marking:{},specific_skills:{type:Object},skills:{type:Object},agent_n2:{type:Object},others:{},goals:{type:Object},validators:{}},setup(s){var L,q;const x=s,E=N().props.auth.user,A=[{name:"Mes Évaluations",href:route("ratings.index"),current:!1},{name:"Rating",href:"#",current:!0}],D=O(()=>{let d=0;return x.goals.forEach(r=>d+=r.goal_mark),d}),S=Q({keyword:"",fields:["user_matricule","user_display_name"]}),h=O(()=>x.validators.filter(d=>d.validator_id===E.user_id)[0]),c=J({validator_id:(L=h.value)==null?void 0:L.validator_id,rating_validator_comment:((q=h.value)==null?void 0:q.rating_validator_comment)||"",new_validator:x.agent_n2.user_id||null}),j=x.others,y=$(""),g=$(j),C=$(!1),G=()=>{c.put(route("validations.update",{validation:h.value.rating_validator_id}),{onError:d=>{N().props.flash.notify={type:"error",message:d.rating_validator_comment}},preserveScroll:!0})},M=()=>U.post(route("users.search"),S);return P(()=>y.value,function(d){let r=d===""?j:j.filter(t=>t.user_matricule.toLowerCase().includes(y.value.toLowerCase())||t.user_display_name.toLowerCase().includes(y.value.toLowerCase()));r.length>0?g.value=r:d.length>=3&&M().then(t=>g.value=t.data)}),(d,r)=>(i(),_(X,null,{default:u(()=>[a(l(R),{title:"Profil"}),e("div",ce,[a(Y,{pages:A}),a(I,{agent:s.agent,rating:s.rating},null,8,["agent","rating"]),a(K,{agent_id:s.agent.user_id,evaluated:!0,rating_id:s.rating.rating_id},null,8,["agent_id","rating_id"]),e("div",me,[e("div",_e,[a(v,{mark:s.rating.specific_skills_sum_rating_skill_mark,marking:s.marking.specific,title:"Compétences Spécifiques (Savoir, Savoir Faire, Savoir Être)"},null,8,["mark","marking"]),l(z)(s.specific_skills)?(i(),n("ul",ue,[(i(!0),n(b,null,w(s.specific_skills,t=>(i(),n("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",ge,[e("div",pe,[e("p",fe,o(t.rating_skill_name||t.phase_skill.skill.skill_name),1),t.rating_skill_mark_is_claimed?(i(),n("p",ve," Contesté")):f("",!0)]),e("div",xe,[e("p",he,o(t.phase_skill.skill.skill_desc),1)])]),e("div",ye,[e("div",ke,[e("p",be,o(t.rating_skill_mark)+" / "+o(t.phase_skill.phase_skill_marking),1)])])]))),128))])):(i(),_(V,{key:1,message:"Les compétences sur lesquelles vous serait évalué s'afficheront ici.",title:"Vous n'avez pas encore été évalué."}))]),e("div",we,[a(v,{mark:s.rating.general_skills_sum_rating_skill_mark,marking:s.marking.general,title:"Compétences Générales"},null,8,["mark","marking"]),e("ul",je,[(i(!0),n(b,null,w(s.skills,t=>(i(),n("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Ce,[e("div",$e,[e("p",Ve,o(t.phase_skill.skill.skill_name),1),t.rating_skill_mark_is_claimed?(i(),n("p",Se," Contesté")):f("",!0)]),e("div",Le,[e("p",qe,o(t.phase_skill.skill.skill_desc),1)])]),e("div",Ne,[e("div",Oe,[e("p",Te,o(t.rating_skill_mark)+" / "+o(t.phase_skill.phase_skill_marking),1)])])]))),128))])]),e("div",Fe,[a(v,{mark:D.value,marking:s.marking.perf,title:"Performances"},null,8,["mark","marking"]),l(z)(s.goals)?(i(),n("ul",ze,[(i(!0),n(b,null,w(s.goals,t=>(i(),n("li",{key:t.goal_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Be,[e("div",Ee,[e("p",Ae,o(t.goal_name),1),e("p",De,o(t.period.evaluation_period_name),1),t.goal_mark_is_claimed?(i(),n("p",Ge," Contesté ")):f("",!0)]),e("div",Me,[e("p",Qe,o(t.goal_expected_result),1)])]),e("div",Je,[e("div",Pe,[e("p",Re,o(t.goal_mark)+" / "+o(t.goal_marking),1)])])]))),128))])):(i(),_(V,{key:1,message:"Les objectifs que votre évaluateur aura crée pour vous s'afficherons automatiquement ici.",title:"Vous n'avez pas encore d'objectif."}))])]),e("div",Ue,[a(v,{title:"Commentaires"}),s.validators?(i(),n("div",Xe,[a(W,{rating:s.rating,validators:s.validators},null,8,["rating","validators"])])):(i(),_(V,{key:1,message:"Les commentaires des validateurs et de l'évalué s'afficheront ici.",title:"Aucun commentaires pour l'instant. "}))]),e("div",Ye,[a(v,{title:"Validation"}),e("div",Ze,[e("form",{onSubmit:T(G,["prevent"])},[e("div",Ie,[e("div",Ke,[We,et,e("div",tt,[e("div",st,[e("div",at,[a(se,{for:"start_date"}),e("div",it,[a(te,{modelValue:l(c).rating_validator_comment,"onUpdate:modelValue":r[0]||(r[0]=t=>l(c).rating_validator_comment=t),invalid:l(c).errors.rating_validator_comment!==void 0},null,8,["modelValue","invalid"])]),a(ae,{message:l(c).errors.rating_validator_comment},null,8,["message"])])])])]),e("div",lt,[rt,nt,e("div",ot,[a(l(oe),{modelValue:l(c).new_validator,"onUpdate:modelValue":r[2]||(r[2]=t=>l(c).new_validator=t)},{default:u(()=>[e("div",dt,[a(l(le),{class:p([l(c).errors.validator_id!==void 0?"focus:ring-red-600 ring-red-600":"","w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-12 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-cyan-600 sm:text-sm sm:leading-6"]),"display-value":t=>{let m=g.value.filter(k=>k.user_id===t)[0];return m?m.user_matricule+" "+m.user_display_name:s.agent_n2.user_matricule+" "+s.agent_n2.user_display_name},placeholder:"Trouver votre N + 1",onChange:r[1]||(r[1]=t=>{S.keyword=y.value=t.target.value})},null,8,["class","display-value"]),a(l(re),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:u(()=>[a(l(ie),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})]),_:1}),g.value.length>0?(i(),_(l(ne),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:u(()=>[(i(!0),n(b,null,w(g.value,t=>(i(),_(l(de),{key:t.user_id,value:t.user_id,as:"template"},{default:u(({active:m,selected:k})=>[e("li",{class:p(["relative cursor-default select-none py-2 pl-3 pr-9",m?"bg-cyan-600 text-white":"text-gray-900"])},[e("div",ct,[e("span",{class:p(["truncate",k&&"font-semibold"])},o((t==null?void 0:t.user_matricule)+" "+(t==null?void 0:t.user_display_name)),3)]),k?(i(),n("span",{key:0,class:p(["absolute inset-y-0 right-0 flex items-center pr-4",m?"text-white":"text-cyan-600"])},[a(l(B),{"aria-hidden":"true",class:"h-5 w-5"})],2)):f("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):f("",!0)])]),_:1},8,["modelValue"])])])]),e("div",mt,[a(Z),e("div",null,[a(H,{disabled:s.rating.rating_is_validated,processing:l(c).processing,class:"mt-3 sm:ml-3 sm:mt-0 sm:w-auto",type:"submit"},{default:u(()=>[F(" Enregistrer ")]),_:1},8,["disabled","processing"]),e("button",{class:p([s.rating.rating_is_validated?"bg-gray-600":"bg-cyan-600 focus-visible:outline-cyan-600 hover:bg-cyan-500","inline-flex gap-x-1.5 disabled:opacity-70 rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 mt-3 sm:ml-3 sm:mt-0 sm:w-auto"]),disabled:s.rating.rating_is_validated,onClick:r[3]||(r[3]=T(t=>C.value=!0,["prevent"]))},[F("Valider "),a(l(B),{class:"text-white -mr-0.5 h-5 w-5"})],10,_t)])])],40,He)])])]),a(ee,{opened:C.value,validation:h.value,onCloseModal:r[4]||(r[4]=t=>C.value=!1)},null,8,["opened","validation"])]),_:1}))}};export{Ot as default};
