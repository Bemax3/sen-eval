import{Q as q,b as H,d as J,T as R,r as $,w as U,o as i,e as u,f as g,g as r,u as s,Z as X,a as e,c as l,F as b,i as w,h as O,n as x,j as m,k as T,t as n,l as P}from"./app-e4fe6d8c.js";import{_ as Z,h as z,c as M,m as V}from"./AuthenticatedLayout-5f178db5.js";import{_ as I}from"./Breadcrumbs-3fa0880f.js";import{_ as K}from"./FormIndications-dad71e4b.js";import{_ as W}from"./SubmitButton-c51ff986.js";import{_ as ee,a as te}from"./Title-c2b5137e.js";import{_ as v,a as se,b as ae}from"./ValidationWarning-239ee824.js";import{_ as Y}from"./EmptyState-6a5ef778.js";import{_ as ie}from"./TextArea-952daf78.js";import{_ as re}from"./InputLabel-8b45f4b3.js";import{_ as le}from"./InputError-c615efff.js";import{r as ne}from"./ChevronUpDownIcon-173d3c94.js";import{r as F}from"./CheckIcon-d11f2fe2.js";import{Q as oe,G as de,X as ce,J as me,Y as _e}from"./combobox-ed68403a.js";import"./logo1637145113-c7398df9.js";import"./SimpleTable-a24068f9.js";import"./TableData-4d88bcca.js";import"./ExclamationTriangleIcon-5599bb9d.js";import"./use-controllable-78d2c8e4.js";const ue={class:"px-4 sm:px-6 lg:px-8"},ge={role:"list"},pe={class:"px-4 py-4 sm:px-0"},fe={key:0,class:"divide-y divide-gray-100",role:"list"},xe={class:"min-w-0"},ve={class:"flex items-start gap-x-3"},he={class:"text-base font-bold leading-6 text-gray-900"},ye={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},ke={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},be={class:"whitespace-break-spaces"},we={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500"},je={class:"whitespace-break-spaces"},Ce={class:"flex flex-none items-center gap-x-4"},$e={class:"flex items-center justify-center space-x-4"},Me={class:"ml-0.5 font-bold"},Ve={class:"px-4 py-4 sm:px-0"},Ye={class:"divide-y divide-gray-100",role:"list"},De={class:"min-w-0"},Ne={class:"flex items-start gap-x-3"},Se={class:"text-base font-bold leading-6 text-gray-900"},Le={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},qe={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},He={class:"whitespace-break-spaces"},Oe={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500"},Te={class:"whitespace-break-spaces"},ze={class:"flex flex-none items-center gap-x-4"},Fe={class:"flex items-center justify-center space-x-4"},Be={class:"ml-0.5 font-bold"},Ee={class:"px-4 py-4 sm:px-0"},Ae={key:0,class:"divide-y divide-gray-100",role:"list"},Ge={class:"min-w-0"},Qe={class:"flex items-start gap-x-3"},Je={class:"text-base font-bold leading-6 text-gray-900"},Re={class:"text-white bg-gray-500 ring-gray-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Ue={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Xe={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},Pe={class:"whitespace-break-spaces"},Ze={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500"},Ie={class:"whitespace-break-spaces"},Ke={class:"flex flex-none items-center gap-x-4"},We={class:"flex items-center justify-center space-x-4"},et={class:"ml-0.5 font-bold"},tt={class:"px-4 py-4 sm:px-0"},st={key:0},at={class:"px-4 py-4 sm:px-0"},it={class:"mt-8 bg-white shadow sm:rounded-lg"},rt=["onSubmit"],lt={class:"grid grid-cols-1 gap-2 sm:grid-cols-2"},nt={class:"px-4 py-5 sm:p-6"},ot=e("h3",{class:"text-base font-semibold leading-6 text-gray-900"},"Commentaire",-1),dt=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500"},[e("p",null,"Ajouter un commentaire. ")],-1),ct={class:"mt-5 sm:flex sm:items-center"},mt={class:"w-full sm:max-w-xl"},_t={class:"col-span-full"},ut={class:"mt-2"},gt={class:"px-4 py-5 sm:p-6"},pt=e("h3",{class:"text-base font-semibold leading-6 text-gray-900"},"Transférer",-1),ft=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500"},[e("p",null,"Transférer l'évaluation au supérieur hiérarchique. ")],-1),xt={class:"mt-6 w-full sm:max-w-xl"},vt={class:"relative"},ht={class:"flex"},yt={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},kt=["disabled"],Et={__name:"RatingSkills",props:{rating:{type:Object},agent:{type:Object},marking:{},specific_skills:{type:Object},skills:{type:Object},agent_n2:{type:Object},others:{},goals:{type:Object},validators:{}},setup(a){var N,S,L;const p=a,B=q().props.auth.user,E=[{name:"Mes Évaluations",href:route("ratings.index"),current:!1},{name:"Rating",href:"#",current:!0}],A=H(()=>{let d=0;return p.goals.forEach(o=>d+=o.goal_mark),d}),D=J({keyword:"",fields:["user_matricule","user_display_name"]}),h=H(()=>p.validators.filter(d=>d.validator_id===B.user_id)[0]),c=R({validator_id:(N=h.value)==null?void 0:N.validator_id,rating_validator_comment:((S=h.value)==null?void 0:S.rating_validator_comment)||"",new_validator:((L=p.agent_n2)==null?void 0:L.user_id)||p.others[0].user_id}),j=p.others,y=$(""),f=$(j),C=$(!1),G=()=>{c.put(route("validations.update",{validation:h.value.rating_validator_id}),{onError:d=>{q().props.flash.notify={type:"error",message:d.rating_validator_comment}},preserveScroll:!0})},Q=()=>P.post(route("users.search"),D);return U(()=>y.value,function(d){let o=d===""?j:j.filter(t=>t.user_matricule.toLowerCase().includes(y.value.toLowerCase())||t.user_display_name.toLowerCase().includes(y.value.toLowerCase()));o.length>0?f.value=o:d.length>=3&&Q().then(t=>f.value=t.data)}),(d,o)=>(i(),u(Z,null,{default:g(()=>[r(s(X),{title:"Évaluation"}),e("div",ue,[r(I,{pages:E}),r(ee,{agent:a.agent,rating:a.rating},null,8,["agent","rating"]),r(te,{agent_id:a.agent.user_id,evaluated:!0,rating_id:a.rating.rating_id},null,8,["agent_id","rating_id"]),e("div",ge,[e("div",pe,[r(v,{mark:a.rating.specific_skills_sum_rating_skill_mark,marking:a.marking.specific,title:"Compétences Spécifiques (Savoir, Savoir Faire, Savoir Être)"},null,8,["mark","marking"]),s(z)(a.specific_skills)?(i(),l("ul",fe,[(i(!0),l(b,null,w(a.specific_skills,t=>(i(),l("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",xe,[e("div",ve,[e("p",he,n(t.rating_skill_name||t.phase_skill.skill.skill_name),1),t.rating_skill_mark_is_claimed?(i(),l("p",ye," Contesté")):m("",!0)]),e("div",ke,[e("p",be,n(t.phase_skill.skill.skill_desc),1)]),t.rating_skill_mark>0?(i(),l("div",we,[e("p",je,"Note attribué le "+n(s(M)(s(V)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):m("",!0)]),e("div",Ce,[e("div",$e,[e("p",Me,n(t.rating_skill_mark)+" / "+n(t.phase_skill.phase_skill_marking),1)])])]))),128))])):(i(),u(Y,{key:1,message:"Les compétences sur lesquelles vous serait évalué s'afficheront ici.",title:"Vous n'avez pas encore été évalué."}))]),e("div",Ve,[r(v,{mark:a.rating.general_skills_sum_rating_skill_mark,marking:a.marking.general,title:"Compétences Générales"},null,8,["mark","marking"]),e("ul",Ye,[(i(!0),l(b,null,w(a.skills,t=>(i(),l("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",De,[e("div",Ne,[e("p",Se,n(t.phase_skill.skill.skill_name),1),t.rating_skill_mark_is_claimed?(i(),l("p",Le," Contesté ")):m("",!0)]),e("div",qe,[e("p",He,n(t.phase_skill.skill.skill_desc),1)]),t.rating_skill_mark>0?(i(),l("div",Oe,[e("p",Te,"Note attribué le "+n(s(M)(s(V)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):m("",!0)]),e("div",ze,[e("div",Fe,[e("p",Be,n(t.rating_skill_mark)+" / "+n(t.phase_skill.phase_skill_marking),1)])])]))),128))])]),e("div",Ee,[r(v,{mark:A.value,marking:a.marking.perf,title:"Performances"},null,8,["mark","marking"]),s(z)(a.goals)?(i(),l("ul",Ae,[(i(!0),l(b,null,w(a.goals,t=>(i(),l("li",{key:t.goal_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Ge,[e("div",Qe,[e("p",Je,n(t.goal_name),1),e("p",Re,n(t.period.evaluation_period_name),1),t.goal_mark_is_claimed?(i(),l("p",Ue," Contesté ")):m("",!0)]),e("div",Xe,[e("p",Pe,n(t.goal_expected_result),1)]),t.goal_mark>0?(i(),l("div",Ze,[e("p",Ie,"Note attribué le "+n(s(M)(s(V)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):m("",!0)]),e("div",Ke,[e("div",We,[e("p",et,n(t.goal_mark)+" / "+n(t.goal_marking),1)])])]))),128))])):(i(),u(Y,{key:1,message:"Les objectifs que votre évaluateur aura crée pour vous s'afficherons automatiquement ici.",title:"Vous n'avez pas encore d'objectif."}))])]),e("div",tt,[r(v,{title:"Commentaires"}),a.validators?(i(),l("div",st,[r(se,{rating:a.rating,validators:a.validators},null,8,["rating","validators"])])):(i(),u(Y,{key:1,message:"Les commentaires des validateurs et de l'évalué s'afficheront ici.",title:"Aucun commentaires pour l'instant. "}))]),e("div",at,[r(v,{title:"Validation"}),e("div",it,[e("form",{onSubmit:O(G,["prevent"])},[e("div",lt,[e("div",nt,[ot,dt,e("div",ct,[e("div",mt,[e("div",_t,[r(re,{for:"start_date"}),e("div",ut,[r(ie,{modelValue:s(c).rating_validator_comment,"onUpdate:modelValue":o[0]||(o[0]=t=>s(c).rating_validator_comment=t),invalid:s(c).errors.rating_validator_comment!==void 0},null,8,["modelValue","invalid"])]),r(le,{message:s(c).errors.rating_validator_comment},null,8,["message"])])])])]),e("div",gt,[pt,ft,e("div",xt,[r(s(me),{modelValue:s(c).new_validator,"onUpdate:modelValue":o[2]||(o[2]=t=>s(c).new_validator=t)},{default:g(()=>[e("div",vt,[r(s(oe),{class:x([s(c).errors.validator_id!==void 0?"focus:ring-red-600 ring-red-600":"","w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-12 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-cyan-700 sm:text-sm sm:leading-6"]),"display-value":t=>{let _=f.value.filter(k=>k.user_id===t)[0];return _?_.user_matricule+" "+_.user_display_name:a.agent_n2.user_matricule+" "+a.agent_n2.user_display_name},placeholder:"Trouver votre N + 1",onChange:o[1]||(o[1]=t=>{D.keyword=y.value=t.target.value})},null,8,["class","display-value"]),r(s(de),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:g(()=>[r(s(ne),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})]),_:1}),f.value.length>0?(i(),u(s(ce),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:g(()=>[(i(!0),l(b,null,w(f.value,t=>(i(),u(s(_e),{key:t.user_id,value:t.user_id,as:"template"},{default:g(({active:_,selected:k})=>[e("li",{class:x(["relative cursor-default select-none py-2 pl-3 pr-9",_?"bg-cyan-600  text-white":"text-gray-900"])},[e("div",ht,[e("span",{class:x(["truncate",k&&"font-semibold"])},n((t==null?void 0:t.user_matricule)+" "+(t==null?void 0:t.user_display_name)),3)]),k?(i(),l("span",{key:0,class:x(["absolute inset-y-0 right-0 flex items-center pr-4",_?"text-white":"text-cyan-600"])},[r(s(F),{"aria-hidden":"true",class:"h-5 w-5"})],2)):m("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):m("",!0)])]),_:1},8,["modelValue"])])])]),e("div",yt,[r(K),e("div",null,[r(W,{disabled:a.rating.rating_is_validated,processing:s(c).processing,class:"mt-3 sm:ml-3 sm:mt-0 sm:w-auto",type:"submit"},{default:g(()=>[T(" Enregistrer ")]),_:1},8,["disabled","processing"]),e("button",{class:x([a.rating.rating_is_validated?"bg-gray-600":"bg-cyan-600  focus-visible:outline-cyan-600 hover:bg-cyan-700    ","inline-flex gap-x-1.5 disabled:opacity-70 rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 mt-3 sm:ml-3 sm:mt-0 sm:w-auto"]),disabled:a.rating.rating_is_validated,onClick:o[3]||(o[3]=O(t=>C.value=!0,["prevent"]))},[T("Valider "),r(s(F),{class:"text-white -mr-0.5 h-5 w-5"})],10,kt)])])],40,rt)])])]),r(ae,{opened:C.value,validation:h.value,onCloseModal:o[4]||(o[4]=t=>C.value=!1)},null,8,["opened","validation"])]),_:1}))}};export{Et as default};
