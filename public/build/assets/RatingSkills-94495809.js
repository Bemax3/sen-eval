import{Q as D,b as h,h as T,T as A,r as k,w as R,o as l,d as g,e as S,f as a,u as n,Z as G,a as e,c as r,F as y,j as b,i as L,g as N,n as P,t as i,k as w,l as Q}from"./app-2ea43d72.js";import{_ as U,a as H,c as j,m as M}from"./AuthenticatedLayout-ed8aacb8.js";import{_ as Z}from"./Breadcrumbs-ee7970c9.js";import{_ as I}from"./FormIndications-70bd8a7e.js";import{_ as J}from"./SubmitButton-a489f48a.js";import{_ as K,a as W}from"./Title-80b31854.js";import{_ as u,a as X,b as ee}from"./ValidationWarning-af94e1d5.js";import{a as $}from"./EmptyState-9f4097d4.js";import{_ as te}from"./TextArea-e75b9d4a.js";import{_ as se}from"./InputLabel-a1ed84c0.js";import{_ as ae}from"./InputError-d22a2d06.js";import{r as ie}from"./CheckIcon-0c2a165e.js";import"./logo1637145113-c7398df9.js";import"./SimpleTable-90e5b2ff.js";import"./ExclamationTriangleIcon-52de5f6a.js";const le={class:"px-4 sm:px-6 lg:px-8"},ne={role:"list"},oe={class:"px-4 py-4 sm:px-0"},re={key:0,class:"divide-y divide-gray-100",role:"list"},de={class:"min-w-0"},ce={class:"flex items-start gap-x-3"},me={class:"text-base font-bold leading-6 text-gray-900"},_e={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},ue={class:"whitespace-break-spaces"},ge={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500"},ve={class:"whitespace-break-spaces"},pe={class:"flex flex-none items-center gap-x-4"},fe={class:"flex items-center justify-center space-x-4"},xe={class:"ml-0.5 font-bold"},he={class:"px-4 py-4 sm:px-0"},ke={class:"divide-y divide-gray-100",role:"list"},ye={class:"min-w-0"},be={class:"flex items-start gap-x-3"},we={class:"text-base font-bold leading-6 text-gray-900"},je={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},Me={class:"whitespace-break-spaces"},$e={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500"},Ce={class:"whitespace-break-spaces"},Ve={class:"flex flex-none items-center gap-x-4"},Ye={class:"flex items-center justify-center space-x-4"},De={class:"ml-0.5 font-bold"},Se={class:"px-4 py-4 sm:px-0"},Le={key:0,class:"divide-y divide-gray-100",role:"list"},Ne={class:"min-w-0"},He={class:"flex items-start gap-x-3"},Oe={class:"text-base font-bold leading-6 text-gray-900"},qe={class:"text-white bg-gray-500 ring-gray-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Fe={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},ze={class:"whitespace-break-spaces"},Be={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500"},Ee={class:"whitespace-break-spaces"},Te={class:"flex flex-none items-center gap-x-4"},Ae={class:"flex items-center justify-center space-x-4"},Re={class:"ml-0.5 font-bold"},Ge={class:"px-4 py-4 sm:px-0"},Pe={key:0},Qe={class:"px-4 py-4 sm:px-0"},Ue={class:"mt-8 bg-white shadow sm:rounded-lg"},Ze=["onSubmit"],Ie={class:"grid grid-cols-1 gap-2 sm:grid-cols-2"},Je={class:"px-4 py-5 sm:p-6"},Ke=e("h3",{class:"text-base font-semibold leading-6 text-gray-900"},"Commentaire",-1),We=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500"},[e("p",null,"Ajouter un commentaire. ")],-1),Xe={class:"mt-5 sm:flex sm:items-center"},et={class:"w-full sm:max-w-xl"},tt={class:"col-span-full"},st={class:"mt-2"},at={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},it=["disabled"],kt={__name:"RatingSkills",props:{rating:{type:Object},agent:{type:Object},marking:{},specific_skills:{type:Object},skills:{type:Object},agent_n2:{type:Object},others:{},goals:{type:Object},validators:{}},setup(s){var V,Y;const _=s,O=D().props.auth.user,q=[{name:"Mes Évaluations",href:route("ratings.index"),current:!1},{name:"Rating",href:"#",current:!0}],F=h(()=>{let o=0;return _.goals.forEach(d=>o+=d.goal_mark),o}),z=T({keyword:"",fields:["user_matricule","user_display_name"]}),v=h(()=>_.validators.filter(o=>o.validator_id===_.rating.evaluator_id)[0]),c=h(()=>_.validators.filter(o=>o.validator_id===O.user_id)[0]),m=A({validator_id:(V=c.value)==null?void 0:V.validator_id,rating_validator_comment:((Y=c.value)==null?void 0:Y.rating_validator_comment)||""}),p=_.others,f=k(""),C=k(p),x=k(!1),B=()=>{m.put(route("validations.update",{validation:c.value.rating_validator_id}),{onError:o=>{D().props.flash.notify={type:"error",message:o.rating_validator_comment}},preserveScroll:!0})},E=()=>Q.post(route("users.search"),z);return R(()=>f.value,function(o){let d=o===""?p:p.filter(t=>t.user_matricule.toLowerCase().includes(f.value.toLowerCase())||t.user_display_name.toLowerCase().includes(f.value.toLowerCase()));d.length>0?C.value=d:o.length>=3&&E().then(t=>C.value=t.data)}),(o,d)=>(l(),g(U,null,{default:S(()=>[a(n(G),{title:"Évaluation"}),e("div",le,[a(Z,{pages:q}),a(K,{agent:s.agent,rating:s.rating},null,8,["agent","rating"]),a(W,{agent_id:s.agent.user_id,evaluated:!0,rating_id:s.rating.rating_id},null,8,["agent_id","rating_id"]),e("div",ne,[e("div",oe,[a(u,{mark:s.rating.specific_skills_sum_rating_skill_mark,marking:s.marking.specific,title:"Compétences Spécifiques (Savoir, Savoir Faire, Savoir Être)"},null,8,["mark","marking"]),n(H)(s.specific_skills)?(l(),r("ul",re,[(l(!0),r(y,null,b(s.specific_skills,t=>(l(),r("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",de,[e("div",ce,[e("p",me,i(t.rating_skill_name||t.phase_skill.skill.skill_name),1)]),e("div",_e,[e("p",ue,i(t.phase_skill.skill.skill_desc),1)]),t.rating_skill_mark>0?(l(),r("div",ge,[e("p",ve,"Note attribué le "+i(n(j)(n(M)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):w("",!0)]),e("div",pe,[e("div",fe,[e("p",xe,i(t.rating_skill_mark)+" / "+i(t.phase_skill.phase_skill_marking),1)])])]))),128))])):(l(),g($,{key:1,message:"Les compétences sur lesquelles vous serait évalué s'afficheront ici.",title:"Vous n'avez pas encore été évalué."}))]),e("div",he,[a(u,{mark:s.rating.general_skills_sum_rating_skill_mark,marking:s.marking.general,title:"Compétences Générales"},null,8,["mark","marking"]),e("ul",ke,[(l(!0),r(y,null,b(s.skills,t=>(l(),r("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",ye,[e("div",be,[e("p",we,i(t.phase_skill.skill.skill_name),1)]),e("div",je,[e("p",Me,i(t.phase_skill.skill.skill_desc),1)]),t.rating_skill_mark>0?(l(),r("div",$e,[e("p",Ce,"Note attribué le "+i(n(j)(n(M)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):w("",!0)]),e("div",Ve,[e("div",Ye,[e("p",De,i(t.rating_skill_mark)+" / "+i(t.phase_skill.phase_skill_marking),1)])])]))),128))])]),e("div",Se,[a(u,{mark:F.value,marking:s.marking.perf,title:"Performances"},null,8,["mark","marking"]),n(H)(s.goals)?(l(),r("ul",Le,[(l(!0),r(y,null,b(s.goals,t=>(l(),r("li",{key:t.goal_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Ne,[e("div",He,[e("p",Oe,i(t.goal_name),1),e("p",qe,i(t.period.evaluation_period_name),1)]),e("div",Fe,[e("p",ze," Taux de réalisation : "+i(t.goal_rate)+" % / Valeur Cible : "+i(t.goal_expected_result)+" % ",1)]),t.goal_mark>0?(l(),r("div",Be,[e("p",Ee,"Note attribué le "+i(n(j)(n(M)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):w("",!0)]),e("div",Te,[e("div",Ae,[e("p",Re,i(t.goal_mark)+" / "+i(t.goal_marking),1)])])]))),128))])):(l(),g($,{key:1,message:"Les objectifs que votre évaluateur aura crée pour vous s'afficherons automatiquement ici.",title:"Vous n'avez pas encore d'objectif."}))])]),e("div",Ge,[a(u,{title:"Commentaires"}),s.validators?(l(),r("div",Pe,[a(X,{rating:s.rating,validators:s.validators},null,8,["rating","validators"])])):(l(),g($,{key:1,message:"Les commentaires des validateurs et de l'évalué s'afficheront ici.",title:"Aucun commentaires pour l'instant. "}))]),e("div",Qe,[a(u,{title:"Validation"}),e("div",Ue,[e("form",{onSubmit:L(B,["prevent"])},[e("div",Ie,[e("div",Je,[Ke,We,e("div",Xe,[e("div",et,[e("div",tt,[a(se,{for:"start_date"}),e("div",st,[a(te,{modelValue:n(m).rating_validator_comment,"onUpdate:modelValue":d[0]||(d[0]=t=>n(m).rating_validator_comment=t),invalid:n(m).errors.rating_validator_comment!==void 0},null,8,["modelValue","invalid"])]),a(ae,{message:n(m).errors.rating_validator_comment},null,8,["message"])])])])])]),e("div",at,[a(I),e("div",null,[a(J,{disabled:s.rating.rating_is_validated||c.value.has_validated||!v.value.has_validated,processing:n(m).processing,class:"mt-3 sm:ml-3 sm:mt-0 sm:w-auto",type:"submit"},{default:S(()=>[N(" Enregistrer ")]),_:1},8,["disabled","processing"]),e("button",{class:P([s.rating.rating_is_validated||c.value.has_validated||!v.value.has_validated?"bg-gray-600":"bg-cyan-600  focus-visible:outline-cyan-600 hover:bg-cyan-700    ","inline-flex gap-x-1.5 disabled:opacity-70 rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 mt-3 sm:ml-3 sm:mt-0 sm:w-auto"]),disabled:s.rating.rating_is_validated||c.value.has_validated||!v.value.has_validated,onClick:d[1]||(d[1]=L(t=>x.value=!0,["prevent"]))},[N("Valider "),a(n(ie),{class:"text-white -mr-0.5 h-5 w-5"})],10,it)])])],40,Ze)])])]),a(ee,{opened:x.value,validation:c.value,onCloseModal:d[2]||(d[2]=t=>x.value=!1)},null,8,["opened","validation"])]),_:1}))}};export{kt as default};
