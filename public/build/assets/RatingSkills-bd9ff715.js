import{Q as D,b as h,h as T,T as A,r as k,w as R,o as l,d as u,e as S,f as a,u as r,Z as G,a as e,c as o,F as y,j as b,t as i,k as w,i as L,g as N,n as P,m as Q}from"./app-c51809d2.js";import{_ as U}from"./AuthenticatedLayout-b0b54744.js";import{_ as Z}from"./Breadcrumbs-6cd41b84.js";import{_ as I}from"./FormIndications-38155857.js";import{_ as J}from"./SubmitButton-42dd88ba.js";import{_ as K,a as W}from"./Title-3522fcb7.js";import{_ as g,a as X,b as ee}from"./ValidationWarning-b83dea7f.js";import{b as j}from"./EmptyState-ab9bb41f.js";import{a as H,c as M,m as $}from"./helper-f88ff6de.js";import{_ as te}from"./TextArea-99af695b.js";import{_ as se}from"./InputLabel-be02b7d5.js";import{_ as ae}from"./InputError-9650500a.js";import{r as ie}from"./CheckIcon-37fba7ec.js";import"./logo1637145113-c7398df9.js";import"./SimpleTable-ac30a7da.js";import"./ExclamationTriangleIcon-a9712964.js";const le={class:"px-4 sm:px-6 lg:px-8"},re={role:"list"},ne={class:"px-4 py-4 sm:px-0"},oe={key:0,class:"divide-y divide-gray-100 dark:divide-gray-600",role:"list"},de={class:"min-w-0"},ce={class:"flex items-start gap-x-3"},me={class:"text-base font-bold leading-6 text-gray-900 dark:text-white"},_e={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500 dark:text-gray-100"},ge={class:"whitespace-break-spaces"},ue={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500 dark:text-gray-100"},ve={class:"whitespace-break-spaces"},pe={class:"flex flex-none items-center gap-x-4"},fe={class:"flex items-center justify-center space-x-4"},xe={class:"ml-0.5 font-bold dark:text-white"},he={class:"px-4 py-4 sm:px-0"},ke={class:"divide-y divide-gray-100 dark:divide-gray-600",role:"list"},ye={class:"min-w-0"},be={class:"flex items-start gap-x-3"},we={class:"text-base font-bold leading-6 text-gray-900 dark:text-white"},je={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500 dark:text-gray-100"},Me={class:"whitespace-break-spaces"},$e={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500 dark:text-gray-100"},Ce={class:"whitespace-break-spaces"},Ve={class:"flex flex-none items-center gap-x-4"},Ye={class:"flex items-center justify-center space-x-4"},De={class:"ml-0.5 font-bold dark:text-white"},Se={class:"px-4 py-4 sm:px-0"},Le={key:0,class:"divide-y divide-gray-100 dark:divide-gray-600",role:"list"},Ne={class:"min-w-0"},He={class:"flex items-start gap-x-3"},Oe={class:"text-base font-bold leading-6 text-gray-900 dark:text-white"},qe={class:"text-white bg-gray-500 ring-gray-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Fe={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500 dark:text-gray-100"},ze={class:"whitespace-break-spaces"},Be={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500 dark:text-gray-100"},Ee={class:"whitespace-break-spaces"},Te={class:"flex flex-none items-center gap-x-4"},Ae={class:"flex items-center justify-center space-x-4"},Re={class:"ml-0.5 font-bold dark:text-white"},Ge={class:"px-4 py-4 sm:px-0"},Pe={key:0},Qe={class:"px-4 py-4 sm:px-0"},Ue={class:"mt-8 bg-white dark:bg-grayish shadow sm:rounded-lg"},Ze=["onSubmit"],Ie={class:"grid grid-cols-1 gap-2 sm:grid-cols-2"},Je={class:"px-4 py-5 sm:p-6"},Ke=e("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},"Commentaire",-1),We=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500 dark:text-gray-100"},[e("p",null,"Ajouter un commentaire. ")],-1),Xe={class:"mt-5 sm:flex sm:items-center"},et={class:"w-full sm:max-w-xl"},tt={class:"col-span-full"},st={class:"mt-2"},at={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},it=["disabled"],yt={__name:"RatingSkills",props:{rating:{type:Object},agent:{type:Object},marking:{},specific_skills:{type:Object},skills:{type:Object},agent_n2:{type:Object},others:{},goals:{type:Object},validators:{}},setup(s){var V,Y;const _=s,O=D().props.auth.user,q=[{name:"Mes Évaluations",href:route("ratings.index"),current:!1},{name:"Rating",href:"#",current:!0}],F=h(()=>{let n=0;return _.goals.forEach(d=>n+=d.goal_mark),n}),z=T({keyword:"",fields:["user_matricule","user_display_name"]}),v=h(()=>_.validators.filter(n=>n.validator_id===_.rating.evaluator_id)[0]),c=h(()=>_.validators.filter(n=>n.validator_id===O.user_id)[0]),m=A({validator_id:(V=c.value)==null?void 0:V.validator_id,rating_validator_comment:((Y=c.value)==null?void 0:Y.rating_validator_comment)||""}),p=_.others,f=k(""),C=k(p),x=k(!1),B=()=>{m.put(route("validations.update",{validation:c.value.rating_validator_id}),{onError:n=>{D().props.flash.notify={type:"error",message:n.rating_validator_comment}},preserveScroll:!0})},E=()=>Q.post(route("users.search"),z);return R(()=>f.value,function(n){let d=n===""?p:p.filter(t=>t.user_matricule.toLowerCase().includes(f.value.toLowerCase())||t.user_display_name.toLowerCase().includes(f.value.toLowerCase()));d.length>0?C.value=d:n.length>=3&&E().then(t=>C.value=t.data)}),(n,d)=>(l(),u(U,null,{default:S(()=>[a(r(G),{title:"Évaluation"}),e("div",le,[a(Z,{pages:q}),a(K,{agent:s.agent,rating:s.rating},null,8,["agent","rating"]),a(W,{agent_id:s.agent.user_id,evaluated:!0,rating_id:s.rating.rating_id},null,8,["agent_id","rating_id"]),e("div",re,[e("div",ne,[a(g,{mark:s.rating.specific_skills_sum_rating_skill_mark,marking:s.marking.specific,title:"Compétences Spécifiques (Savoir, Savoir Faire, Savoir Être)"},null,8,["mark","marking"]),r(H)(s.specific_skills)?(l(),o("ul",oe,[(l(!0),o(y,null,b(s.specific_skills,t=>(l(),o("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",de,[e("div",ce,[e("p",me,i(t.rating_skill_name||t.phase_skill.skill.skill_name),1)]),e("div",_e,[e("p",ge,i(t.phase_skill.skill.skill_desc),1)]),t.rating_skill_mark>0?(l(),o("div",ue,[e("p",ve,"Note attribué le "+i(r(M)(r($)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):w("",!0)]),e("div",pe,[e("div",fe,[e("p",xe,i(t.rating_skill_mark)+" / "+i(t.phase_skill.phase_skill_marking),1)])])]))),128))])):(l(),u(j,{key:1,message:"Les compétences sur lesquelles vous serait évalué s'afficheront ici.",title:"Vous n'avez pas encore été évalué."}))]),e("div",he,[a(g,{mark:s.rating.general_skills_sum_rating_skill_mark,marking:s.marking.general,title:"Compétences Générales"},null,8,["mark","marking"]),e("ul",ke,[(l(!0),o(y,null,b(s.skills,t=>(l(),o("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",ye,[e("div",be,[e("p",we,i(t.phase_skill.skill.skill_name),1)]),e("div",je,[e("p",Me,i(t.phase_skill.skill.skill_desc),1)]),t.rating_skill_mark>0?(l(),o("div",$e,[e("p",Ce,"Note attribué le "+i(r(M)(r($)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):w("",!0)]),e("div",Ve,[e("div",Ye,[e("p",De,i(t.rating_skill_mark)+" / "+i(t.phase_skill.phase_skill_marking),1)])])]))),128))])]),e("div",Se,[a(g,{mark:F.value,marking:s.marking.perf,title:"Performances"},null,8,["mark","marking"]),r(H)(s.goals)?(l(),o("ul",Le,[(l(!0),o(y,null,b(s.goals,t=>(l(),o("li",{key:t.goal_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Ne,[e("div",He,[e("p",Oe,i(t.goal_name),1),e("p",qe,i(t.period.evaluation_period_name),1)]),e("div",Fe,[e("p",ze," Taux de réalisation : "+i(t.goal_rate)+" % / Valeur Cible : "+i(t.goal_expected_result)+" % ",1)]),t.goal_mark>0?(l(),o("div",Be,[e("p",Ee,"Note attribué le "+i(r(M)(r($)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):w("",!0)]),e("div",Te,[e("div",Ae,[e("p",Re,i(t.goal_mark)+" / "+i(t.goal_marking),1)])])]))),128))])):(l(),u(j,{key:1,message:"Les objectifs que votre évaluateur aura crée pour vous s'afficherons automatiquement ici.",title:"Vous n'avez pas encore d'objectif."}))])]),e("div",Ge,[a(g,{title:"Commentaires"}),s.validators?(l(),o("div",Pe,[a(X,{rating:s.rating,validators:s.validators},null,8,["rating","validators"])])):(l(),u(j,{key:1,message:"Les commentaires des validateurs et de l'évalué s'afficheront ici.",title:"Aucun commentaires pour l'instant. "}))]),e("div",Qe,[a(g,{title:"Validation"}),e("div",Ue,[e("form",{onSubmit:L(B,["prevent"])},[e("div",Ie,[e("div",Je,[Ke,We,e("div",Xe,[e("div",et,[e("div",tt,[a(se,{for:"start_date"}),e("div",st,[a(te,{modelValue:r(m).rating_validator_comment,"onUpdate:modelValue":d[0]||(d[0]=t=>r(m).rating_validator_comment=t),invalid:r(m).errors.rating_validator_comment!==void 0},null,8,["modelValue","invalid"])]),a(ae,{message:r(m).errors.rating_validator_comment},null,8,["message"])])])])])]),e("div",at,[a(I),e("div",null,[a(J,{disabled:s.rating.rating_is_validated||c.value.has_validated||!v.value.has_validated,processing:r(m).processing,class:"mt-3 sm:ml-3 sm:mt-0 sm:w-auto",type:"submit"},{default:S(()=>[N(" Enregistrer ")]),_:1},8,["disabled","processing"]),e("button",{class:P([s.rating.rating_is_validated||c.value.has_validated||!v.value.has_validated?"bg-gray-600":"bg-cyan-600  focus-visible:outline-cyan-600 hover:bg-cyan-700    ","inline-flex gap-x-1.5 disabled:opacity-70 rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 mt-3 sm:ml-3 sm:mt-0 sm:w-auto"]),disabled:s.rating.rating_is_validated||c.value.has_validated||!v.value.has_validated,onClick:d[1]||(d[1]=L(t=>x.value=!0,["prevent"]))},[N("Valider "),a(r(ie),{class:"text-white -mr-0.5 h-5 w-5"})],10,it)])])],40,Ze)])])]),a(ee,{opened:x.value,validation:c.value,onCloseModal:d[2]||(d[2]=t=>x.value=!1)},null,8,["opened","validation"])]),_:1}))}};export{yt as default};
