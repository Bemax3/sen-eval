import{r as Y,w as k,o as d,d as f,e as n,u as e,T as B,f as s,a as t,c,t as u,$ as V,g as y,n as g,p as D,F as z,j as C,k as v,i as j}from"./app-c51809d2.js";import{a as x,h as M,G as E,m as $,U as F,S as P}from"./helper-f88ff6de.js";import{_ as N}from"./InputLabel-be02b7d5.js";import{_ as G}from"./InputError-9650500a.js";import{_ as T}from"./TextArea-99af695b.js";import{_ as H}from"./FormIndications-38155857.js";import{_ as L}from"./SubmitButton-42dd88ba.js";import{_ as S}from"./Switch-4e7456cc.js";import{r as R}from"./ChevronUpDownIcon-f3f22d97.js";import{r as q}from"./CheckIcon-64bcec63.js";import{B as A,N as I,H as J,U as K}from"./listbox-91d0ad42.js";import"./CheckIcon-37fba7ec.js";import"./switch-0def0acf.js";import"./use-controllable-abfeee94.js";const O=t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),Q={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},W={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},X=["onSubmit"],Z=t("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},"Demander une promotion ou un avancement",-1),ee=t("div",{class:"mt-2 max-w-xl text-sm text-gray-500 dark:text-gray-100"},[t("p",null,"Rechercher une promotion ou un avancement et ajouter la à la liste des demandes pour cette évaluation. ")],-1),te={class:"mt-2 max-w-xl text-sm text-gray-500 dark:text-gray-100"},ae={class:"mt-2 max-w-xl text-sm text-gray-500 dark:text-gray-100"},se={class:"px-4 py-6 sm:p-8"},oe={class:"grid max-w-2xl grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},ie={class:"col-span-full relative"},re={class:"relative"},ne={key:0,class:"block truncate"},le={key:1,class:"block truncate"},de={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"},me={class:"col-span-full"},ue={class:"mt-2"},pe={class:"col-span-full"},ce={class:"mt-2"},_e={class:"col-span-full"},ge={class:"mt-2"},fe={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},Be={__name:"SavePromotionModal",props:{opened:{type:Boolean,default:!1},types:{},isValidator:{},isEvaluated:{},rating:{},promotion:{},agent:{}},emits:["closeModal"],setup(r,{emit:h}){const m=r,p=Y(!1);let a;const _=o=>{a=B(o===void 0?{evaluated_is_eligible:0,is_proposed:0,rating_promotion_comment:"",promotion_type_id:x(m.types)?m.types[0].promotion_type_id:null}:{rating_promotion_id:o.rating_promotion_id,evaluated_is_eligible:o.evaluated_is_eligible,is_proposed:o.is_proposed,rating_promotion_comment:o.rating_promotion_comment||"",promotion_type_id:o.promotion_type_id})},U=()=>{a.rating_promotion_id?a.put(route("rating-promotions.update",{rating:m.rating.rating_id,rating_promotion:a.rating_promotion_id}),{onSuccess:o=>{p.value=!1,h("closeModal"),_()}}):a.post(route("rating-promotions.store",{rating:m.rating.rating_id}),{onSuccess:o=>{p.value=!1,h("closeModal"),_()}})};return _(),k(()=>m.opened,o=>{p.value=o},{immediate:!0}),k(()=>m.promotion,o=>{_(o)}),(o,l)=>(d(),f(e(P),{show:p.value,as:"template"},{default:n(()=>[s(e(F),{as:"div",class:"relative z-10",onClose:l[4]||(l[4]=i=>{p.value=!1,o.$emit("closeModal")})},{default:n(()=>[s(e(M),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:n(()=>[O]),_:1}),t("div",Q,[t("div",W,[s(e(M),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:n(()=>[s(e(E),{class:"relative transform overflow-hidden rounded-lg bg-white dark:bg-grayish px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-3xl sm:p-6"},{default:n(()=>[!r.isEvaluated&&!r.isValidator&&!r.rating.rating_is_validated?(d(),c("form",{key:0,onSubmit:j(U,["prevent"])},[Z,ee,t("div",te,[t("p",null,"GF: "+u(r.agent.user_gf)+" promu le "+u(V(e($)(r.agent.user_gf_prom_date).format("DD MMMM YYYY"))),1)]),t("div",ae,[t("p",null,"NR: "+u(r.agent.user_nr)+" promu le "+u(V(e($)(r.agent.user_nr_prom_date).format("DD MMMM YYYY"))),1)]),t("div",se,[t("div",oe,[t("div",ie,[s(N,{for:"start_date",required:""},{default:n(()=>[y("Nature")]),_:1}),s(e(A),{modelValue:e(a).promotion_type_id,"onUpdate:modelValue":l[0]||(l[0]=i=>e(a).promotion_type_id=i)},{default:n(()=>[t("div",re,[s(e(I),{class:g([e(a).errors.phase_id?"ring-red-300":"ring-gray-300","w-full cursor-default rounded-md bg-white dark:bg-grayish py-1.5 pl-3 pr-10 text-left text-gray-900 dark:text-white shadow-sm ring-1 ring-inset focus:outline-none focus:ring-2 focus:ring-cyan-700 sm:text-sm sm:leading-6"])},{default:n(()=>[e(x)(r.types)?(d(),c("span",ne,u(r.types.filter(i=>i.promotion_type_id===e(a).promotion_type_id)[0].promotion_type_name),1)):(d(),c("span",le,"Aucune promotion disponible pour l'instant.")),t("span",de,[s(e(R),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])]),_:1},8,["class"]),s(D,{"leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:n(()=>[e(x)(r.types)?(d(),f(e(J),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white dark:bg-grayish py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:n(()=>[(d(!0),c(z,null,C(r.types,i=>(d(),f(e(K),{key:i.promotion_type_id,value:i.promotion_type_id,as:"template"},{default:n(({active:b,selected:w})=>[t("li",{class:g([b?"bg-cyan-600  text-white":"text-gray-900 dark:text-white","relative cursor-default select-none py-2 pl-3 pr-9"])},[t("span",{class:g([w?"font-semibold":"font-normal","block truncate"])},u(i.promotion_type_name),3),w?(d(),c("span",{key:0,class:g([b?"text-white":"text-cyan-600","absolute inset-y-0 right-0 flex items-center pr-4"])},[s(e(q),{"aria-hidden":"true",class:"h-5 w-5"})],2)):v("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):v("",!0)]),_:1})])]),_:1},8,["modelValue"]),s(G,{message:e(a).errors.promotion_type_id},null,8,["message"])]),t("div",me,[t("div",ue,[s(S,{modelValue:e(a).evaluated_is_eligible,"onUpdate:modelValue":l[1]||(l[1]=i=>e(a).evaluated_is_eligible=i),desc:"L'évalué est-il éligible à cette avancement ou promotion ?",label:"Non Éligible / Éligible"},null,8,["modelValue"])])]),t("div",pe,[t("div",ce,[s(S,{modelValue:e(a).is_proposed,"onUpdate:modelValue":l[2]||(l[2]=i=>e(a).is_proposed=i),desc:"Proposez-vous un avancement ou une promotion pour cette évalué ?",label:"Non Proposé / Proposé"},null,8,["modelValue"])])]),t("div",_e,[s(N,{for:""},{default:n(()=>[y("Commentaire")]),_:1}),t("div",ge,[s(T,{ref:"input",modelValue:e(a).rating_promotion_comment,"onUpdate:modelValue":l[3]||(l[3]=i=>e(a).rating_promotion_comment=i)},null,8,["modelValue"])])])])]),t("div",fe,[s(H),s(L,{disabled:r.rating.rating_is_validated,processing:e(a).processing,class:"mt-3 sm:ml-3 sm:mt-0 sm:w-auto",type:"submit"},{default:n(()=>[y("Enregistrer ")]),_:1},8,["disabled","processing"])])],40,X)):v("",!0)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}};export{Be as default};
