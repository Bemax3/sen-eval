import{o as l,d as p,e as r,T as V,f as s,u as e,Z as j,a as t,t as d,g as _,l as B,i as S,n as u,c as m,p as M,j as C,k as b,F as E,Q as O}from"./app-c51809d2.js";import{_ as F}from"./AuthenticatedLayout-b0b54744.js";import{_ as T}from"./Breadcrumbs-6cd41b84.js";import{_ as U}from"./Separator-3c8b18c5.js";import{_ as q}from"./SectionTitle-bd985838.js";import{_ as z}from"./FormIndications-38155857.js";import{_ as A}from"./InputLabel-be02b7d5.js";import{_ as D}from"./SubmitButton-42dd88ba.js";import{_ as H}from"./InputError-9650500a.js";import{i as c,a as h}from"./helper-f88ff6de.js";import{r as L}from"./ChevronDoubleRightIcon-a1022170.js";import{r as Q}from"./ChevronUpDownIcon-f3f22d97.js";import{r as R}from"./CheckIcon-37fba7ec.js";import{N as Z,H as G,U as I,B as J}from"./listbox-91d0ad42.js";import"./logo1637145113-c7398df9.js";import"./use-controllable-abfeee94.js";const K={class:"px-4 sm:px-6 lg:px-8"},P={class:"sm:flex sm:items-center"},W={class:"sm:flex-auto"},X={class:"text-2xl font-semibold leading-6 text-gray-900 dark:text-white"},Y={class:"mt-2 text-sm text-gray-700 dark:text-white"},ee={class:"space-x-2 mt-4 sm:ml-16 sm:mt-0 sm:flex-none"},te={class:"mt-8 flow-root"},se=["onSubmit"],ae={class:"px-4 py-6 sm:p-8"},ie={class:"grid max-w-2xl grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},ne={class:"sm:col-span-4"},re={class:"mt-2"},oe={class:"relative mt-2"},le={key:0,class:"block truncate"},de={key:1,class:"block truncate"},ce={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"},ue={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},Be={__name:"SaveRating",props:{agent:{type:Object},phases:{type:Object},evaluation:{type:Object,required:!1,default:{}}},setup(i){const a=i,w=c(a.evaluation)?"Nouvelle évaluation":"Modifier l'évaluation",k=c(a.evaluation)?"Créer une evaluation pour cet agent":"Modifier une evaluation pour cet agent",$=[{name:"Évaluations",href:route("agent-ratings.index",{agent:a.agent.user_id}),current:!1},{name:c(a.evaluation)?"Nouvelle":"Modifier",href:"#",current:!0}];let n;const g=()=>{n=V(c(a.evaluation)?{phase_id:h(a.phases)?a.phases[0].phase_id:null,evaluated_id:a.agent.user_id}:{phase_id:a.evaluation.phase_id,evaluated_id:a.agent.user_id})},N=()=>{c(a.evaluation)?n.post(route("agent-ratings.store",{agent:a.agent.user_id}),{onSuccess:()=>g(),onError:f=>O().props.flash.notify={type:"error",message:f.phase_id}}):n.put(route("agent-ratings.update",{agent:a.agent.user_id,rating:a.rating.rating_id}),{onSuccess:()=>g()})};return g(),(f,v)=>(l(),p(F,null,{default:r(()=>[s(e(j),{title:"Nouvel Évaluation"}),t("div",K,[s(T,{pages:$}),t("div",P,[t("div",W,[t("h1",X,"Évaluations de "+d(i.agent.user_first_name+" "+i.agent.user_last_name),1),t("p",Y," Liste des Évaluations de "+d(i.agent.user_first_name+" "+i.agent.user_last_name)+". Matricule : "+d(i.agent.user_matricule),1)]),t("div",ee,[s(e(B),{href:f.route("agent-goals.index",{agent:i.agent.user_id}),as:"button",class:"inline-flex gap-x-1.5 rounded-md bg-cyan-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-cyan-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-600"},{default:r(()=>[_(" Objectif "),s(e(L),{class:"-mr-0.5 h-5 w-5"})]),_:1},8,["href"])])]),s(U,{title:"Évaluations"}),s(q,{desc:e(k),title:e(w)},null,8,["desc","title"]),t("div",te,[t("form",{class:"bg-white dark:bg-grayish shadow-sm ring-1 ring-gray-900/5 sm:rounded-xl md:col-span-2",onSubmit:S(N,["prevent"])},[t("div",ae,[t("div",ie,[t("div",ne,[s(A,{required:""},{default:r(()=>[_("Année d'évaluation")]),_:1}),t("div",re,[s(e(J),{modelValue:e(n).phase_id,"onUpdate:modelValue":v[0]||(v[0]=o=>e(n).phase_id=o),as:"div"},{default:r(()=>[t("div",oe,[s(e(Z),{class:u([e(n).errors.phase_id?"ring-red-300":"ring-gray-300","relative w-full cursor-default rounded-md bg-white dark:bg-grayish py-1.5 pl-3 pr-10 text-left text-gray-900 dark:text-white shadow-sm ring-1 ring-inset focus:outline-none focus:ring-2 focus:ring-cyan-700 sm:text-sm sm:leading-6"])},{default:r(()=>[e(h)(i.phases)?(l(),m("span",le,d(i.phases.filter(o=>o.phase_id===e(n).phase_id)[0].phase_year),1)):(l(),m("span",de,"Aucune année disponible pour l'instant.")),t("span",ce,[s(e(Q),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])]),_:1},8,["class"]),s(M,{"leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:r(()=>[e(h)(i.phases)?(l(),p(e(G),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white dark:bg-grayish py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:r(()=>[(l(!0),m(E,null,C(i.phases,o=>(l(),p(e(I),{key:o.phase_id,value:o.phase_id,as:"template"},{default:r(({active:x,selected:y})=>[t("li",{class:u([x?"bg-cyan-600  text-white":"text-gray-900 dark:text-white","relative cursor-default select-none py-2 pl-3 pr-9"])},[t("span",{class:u([y?"font-semibold":"font-normal","block truncate"])},d(o.phase_year),3),y?(l(),m("span",{key:0,class:u([x?"text-white":"text-cyan-600","absolute inset-y-0 right-0 flex items-center pr-4"])},[s(e(R),{"aria-hidden":"true",class:"h-5 w-5"})],2)):b("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):b("",!0)]),_:1})])]),_:1},8,["modelValue"])]),s(H,{message:e(n).errors.phase_id},null,8,["message"])])])]),t("div",ue,[s(z),s(D,{processing:e(n).processing},{default:r(()=>[_(" Enregistrer")]),_:1},8,["processing"])])],40,se)])])]),_:1}))}};export{Be as default};
