import{r as B,w,o as l,d as f,e as n,u as e,T as N,f as a,a as t,c as u,g,n as p,t as k,p as M,F as U,j as C,k as y,i as j}from"./app-c51809d2.js";import{a as h,h as V,G as z,U as E,S as D}from"./helper-f88ff6de.js";import{_ as S}from"./InputLabel-be02b7d5.js";import{_ as F}from"./InputError-9650500a.js";import{_ as T}from"./TextArea-99af695b.js";import{_ as G}from"./FormIndications-38155857.js";import{_ as H}from"./SubmitButton-42dd88ba.js";import{r as q}from"./ChevronUpDownIcon-f3f22d97.js";import{r as A}from"./CheckIcon-64bcec63.js";import{B as L,N as R,H as I,U as J}from"./listbox-91d0ad42.js";import"./CheckIcon-37fba7ec.js";import"./use-controllable-abfeee94.js";const K=t("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1),O={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},P={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Q=["onSubmit"],W=t("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},"Donner une sanction",-1),X=t("div",{class:"mt-2 max-w-xl text-sm text-gray-500 dark:text-gray-100"},[t("p",null,"Rechercher une sanction et ajouter la à la liste des sanction pour cette évaluation.")],-1),Y={class:"px-4 py-6 sm:p-8"},Z={class:"grid max-w-2xl grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6"},ee={class:"col-span-full relative"},te={class:"relative"},ae={key:0,class:"block truncate"},se={key:1,class:"block truncate"},ne={class:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2"},ie={class:"col-span-full"},oe={class:"mt-2"},re={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},xe={__name:"SaveSanctionModal",props:{opened:{type:Boolean,default:!1},types:{},isValidator:{},isEvaluated:{},rating:{},sanction:{}},emits:["closeModal"],setup(r,{emit:v}){const c=r,m=B(!1);let s;const _=i=>{s=N(i===void 0?{rating_sanction_comment:"",sanction_type_id:h(c.types)?c.types[0].sanction_type_id:null}:{rating_sanction_id:i.rating_sanction_id,rating_sanction_comment:i.rating_sanction_comment||"",sanction_type_id:i.sanction_type_id})},$=()=>{s.rating_sanction_id?s.put(route("rating-sanctions.update",{rating:c.rating.rating_id,rating_sanction:s.rating_sanction_id}),{onSuccess:i=>{m.value=!1,v("closeModal"),_()}}):s.post(route("rating-sanctions.store",{rating:c.rating.rating_id}),{onSuccess:i=>{m.value=!1,v("closeModal"),_()}})};return _(),w(()=>c.opened,i=>{m.value=i},{immediate:!0}),w(()=>c.sanction,i=>{_(i)}),(i,d)=>(l(),f(e(D),{show:m.value,as:"template"},{default:n(()=>[a(e(E),{as:"div",class:"relative z-10",onClose:d[2]||(d[2]=o=>{m.value=!1,i.$emit("closeModal")})},{default:n(()=>[a(e(V),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:n(()=>[K]),_:1}),t("div",O,[t("div",P,[a(e(V),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:n(()=>[a(e(z),{class:"relative transform overflow-hidden rounded-lg bg-white dark:bg-grayish px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-3xl sm:p-6"},{default:n(()=>[!r.isEvaluated&&!r.isValidator&&!r.rating.rating_is_validated?(l(),u("form",{key:0,onSubmit:j($,["prevent"])},[W,X,t("div",Y,[t("div",Z,[t("div",ee,[a(S,{for:"",required:""},{default:n(()=>[g("Nature")]),_:1}),a(e(L),{modelValue:e(s).sanction_type_id,"onUpdate:modelValue":d[0]||(d[0]=o=>e(s).sanction_type_id=o),class:"mt-2"},{default:n(()=>[t("div",te,[a(e(R),{class:p([e(s).errors.phase_id?"ring-red-300":"ring-gray-300","w-full cursor-default rounded-md bg-white dark:bg-grayish py-1.5 pl-3 pr-10 text-left text-gray-900 dark:text-white shadow-sm ring-1 ring-inset focus:outline-none focus:ring-2 focus:ring-cyan-700 sm:text-sm sm:leading-6"])},{default:n(()=>[e(h)(r.types)?(l(),u("span",ae,k(r.types.filter(o=>o.sanction_type_id===e(s).sanction_type_id)[0].sanction_type_name),1)):(l(),u("span",se,"Aucune sanction disponible pour l'instant.")),t("span",ne,[a(e(q),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})])]),_:1},8,["class"]),a(M,{"leave-active-class":"transition ease-in duration-100","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:n(()=>[e(h)(r.types)?(l(),f(e(I),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white dark:bg-grayish py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:n(()=>[(l(!0),u(U,null,C(r.types,o=>(l(),f(e(J),{key:o.sanction_type_id,value:o.sanction_type_id,as:"template"},{default:n(({active:x,selected:b})=>[t("li",{class:p([x?"bg-cyan-600  text-white":"text-gray-900 dark:text-white","relative cursor-default select-none py-2 pl-3 pr-9"])},[t("span",{class:p([b?"font-semibold":"font-normal","block truncate"])},k(o.sanction_type_name),3),b?(l(),u("span",{key:0,class:p([x?"text-white":"text-cyan-600","absolute inset-y-0 right-0 flex items-center pr-4"])},[a(e(A),{"aria-hidden":"true",class:"h-5 w-5"})],2)):y("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):y("",!0)]),_:1})])]),_:1},8,["modelValue"]),a(F,{message:e(s).errors.claim_type_id},null,8,["message"])]),t("div",ie,[a(S,{for:""},{default:n(()=>[g("Commentaire")]),_:1}),t("div",oe,[a(T,{ref:"input",modelValue:e(s).rating_sanction_comment,"onUpdate:modelValue":d[1]||(d[1]=o=>e(s).rating_sanction_comment=o)},null,8,["modelValue"])])])])]),t("div",re,[a(G),a(H,{disabled:r.rating.rating_is_validated,processing:e(s).processing,class:"mt-3 sm:ml-3 sm:mt-0 sm:w-auto",type:"submit"},{default:n(()=>[g("Enregistrer ")]),_:1},8,["disabled","processing"])])],40,Q)):y("",!0)]),_:1})]),_:1})])])]),_:1})]),_:1},8,["show"]))}};export{xe as default};
