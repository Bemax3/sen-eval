import{Q as q,b as O,T as U,d as z,r as $,w as J,o as i,e as u,f as g,g as s,u as a,Z as X,a as e,c as n,F as b,i as k,h as F,n as _,j as p,q as Y,v as R,k as B,t as o,l as Z}from"./app-009e6676.js";import{_ as H,h as D}from"./AuthenticatedLayout-a6827bda.js";import{_ as I}from"./Breadcrumbs-6f218844.js";import{_ as K}from"./FormIndications-fac9b7ef.js";import{_ as W}from"./SubmitButton-d98e5e89.js";import{_ as ee,a as te}from"./Title-db6e0967.js";import{_ as x,a as se,b as ae}from"./ValidationWarning-f757f4ff.js";import{_ as V}from"./EmptyState-148efe32.js";import{_ as ie}from"./InputError-db0f38c0.js";import{_ as re}from"./TextArea-8621ec88.js";import{_ as le}from"./InputLabel-00850faa.js";import{r as ne}from"./ChevronUpDownIcon-99c795d4.js";import{r as N}from"./CheckIcon-44d763b6.js";import{Q as oe,G as de,X as ce,Y as E,J as me}from"./combobox-5ed63abc.js";import"./logo1637145113-11387d37.js";import"./SimpleTable-23339c36.js";import"./TableData-551b2a58.js";import"./ExclamationTriangleIcon-89a7551c.js";import"./PlusIcon-1fd1de74.js";import"./use-controllable-a4a0a7b6.js";const _e={class:"px-4 sm:px-6 lg:px-8"},ue={role:"list"},ge={class:"px-4 py-4 sm:px-0"},pe={key:0,class:"divide-y divide-gray-100",role:"list"},fe={class:"min-w-0"},xe={class:"flex items-start gap-x-3"},ve={class:"text-base font-bold leading-6 text-gray-900"},he={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},ye={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},be={class:"whitespace-break-spaces"},ke={class:"flex flex-none items-center gap-x-4"},we={class:"flex items-center justify-center space-x-4"},Ce={class:"ml-0.5 font-bold"},je={class:"px-4 py-4 sm:px-0"},$e={class:"divide-y divide-gray-100",role:"list"},Ve={class:"min-w-0"},Ne={class:"flex items-start gap-x-3"},Se={class:"text-base font-bold leading-6 text-gray-900"},Le={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Te={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},qe={class:"whitespace-break-spaces"},Oe={class:"flex flex-none items-center gap-x-4"},Fe={class:"flex items-center justify-center space-x-4"},Be={class:"ml-0.5 font-bold"},De={class:"px-4 py-4 sm:px-0"},Ee={key:0,class:"divide-y divide-gray-100",role:"list"},Me={class:"min-w-0"},Pe={class:"flex items-start gap-x-3"},Ae={class:"text-base font-bold leading-6 text-gray-900"},Ge={class:"text-gray-700 bg-gray-50 ring-gray-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Qe={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Ue={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500"},ze={class:"whitespace-break-spaces"},Je={class:"flex flex-none items-center gap-x-4"},Xe={class:"flex items-center justify-center space-x-4"},Ye={class:"ml-0.5 font-bold"},Re={class:"px-4 py-4 sm:px-0"},Ze={key:0},He={class:"px-4 py-4 sm:px-0"},Ie={class:"mt-8 bg-white shadow sm:rounded-lg"},Ke=["onSubmit"],We={class:"grid grid-cols-2 gap-2 sm:grid-cols-2"},et={class:"px-4 py-5 sm:p-6"},tt=e("h3",{class:"text-base font-semibold leading-6 text-gray-900"},"Commentaire",-1),st=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500"},[e("p",null,"Ajouter un commentaire. ")],-1),at={class:"mt-5 sm:flex sm:items-center"},it={class:"w-full sm:max-w-xl"},rt={class:"col-span-full"},lt={class:"mt-2"},nt={class:"px-4 py-5 sm:p-6"},ot=e("h3",{class:"text-base font-semibold leading-6 text-gray-900"},"Transférer",-1),dt=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500"},[e("p",null,"Transférer l'évaluation au supérieur hiérarchique. ")],-1),ct={class:"mt-6 w-full sm:max-w-xl"},mt={class:"relative"},_t={class:"flex"},ut={class:"flex"},gt={class:"mt-3 flex items-center"},pt=e("label",{class:"ml-3 block text-sm leading-6 text-gray-900",for:"remember-n1"},"Sauvegarder en tant que mon N + 1",-1),ft={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},xt=["disabled"],Mt={__name:"ValidateRating",props:{rating:{type:Object},agent:{type:Object},marking:{},specific_skills:{type:Object},skills:{type:Object},goals:{type:Object},validators:{},n1:{type:Object},others:{}},setup(r){var L,T;const w=r,M=q().props.auth.user,P=[{name:"Mes Validations",href:route("ratings.index"),current:!1},{name:"Évaluation",href:"#",current:!0}],A=O(()=>{let c=0;return w.goals.forEach(l=>c+=l.goal_mark),c}),v=O(()=>w.validators.filter(c=>c.validator_id===M.user_id)[0]),d=U({remember:!1,validator_id:(L=v.value)==null?void 0:L.validator_id,rating_validator_comment:((T=v.value)==null?void 0:T.rating_validator_comment)||"",new_validator:-1}),S=z({keyword:"",fields:["user_matricule","user_display_name"]}),C=w.others,h=$(""),f=$(C),j=$(!1),G=()=>{d.put(route("validations.update",{validation:v.value.rating_validator_id}),{onError:c=>{q().props.flash.notify={type:"error",message:c.rating_validator_comment}},preserveScroll:!0})},Q=()=>Z.post(route("users.search"),S);return J(()=>h.value,function(c){let l=c===""?C:C.filter(t=>t.user_matricule.toLowerCase().includes(h.value.toLowerCase())||t.user_display_name.toLowerCase().includes(h.value.toLowerCase()));l.length>0?f.value=l:c.length>=3&&Q().then(t=>f.value=t.data)}),(c,l)=>(i(),u(H,null,{default:g(()=>[s(a(X),{title:"Profil"}),e("div",_e,[s(I,{pages:P}),s(ee,{agent:r.agent,rating:r.rating},null,8,["agent","rating"]),s(te,{agent_id:r.agent.user_id,rating_id:r.rating.rating_id,validator:!0},null,8,["agent_id","rating_id"]),e("div",ue,[e("div",ge,[s(x,{mark:r.rating.specific_skills_sum_rating_skill_mark,marking:r.marking.specific,title:"Compétences Spécifiques (Savoir, Savoir Faire, Savoir Être)"},null,8,["mark","marking"]),a(D)(r.specific_skills)?(i(),n("ul",pe,[(i(!0),n(b,null,k(r.specific_skills,t=>(i(),n("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",fe,[e("div",xe,[e("p",ve,o(t.rating_skill_name||t.phase_skill.skill.skill_name),1),t.rating_skill_mark_is_claimed?(i(),n("p",he," Contesté")):p("",!0)]),e("div",ye,[e("p",be,o(t.phase_skill.skill.skill_desc),1)])]),e("div",ke,[e("div",we,[e("p",Ce,o(t.rating_skill_mark)+" / "+o(t.phase_skill.phase_skill_marking),1)])])]))),128))])):(i(),u(V,{key:1,message:"Les compétences évaluées s'afficheront ici.",title:"Pas encore de compétences évaluées."}))]),e("div",je,[s(x,{mark:r.rating.general_skills_sum_rating_skill_mark,marking:r.marking.general,title:"Compétences Générales"},null,8,["mark","marking"]),e("ul",$e,[(i(!0),n(b,null,k(r.skills,t=>(i(),n("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Ve,[e("div",Ne,[e("p",Se,o(t.phase_skill.skill.skill_name),1),t.rating_skill_mark_is_claimed?(i(),n("p",Le," Contesté")):p("",!0)]),e("div",Te,[e("p",qe,o(t.phase_skill.skill.skill_desc),1)])]),e("div",Oe,[e("div",Fe,[e("p",Be,o(t.rating_skill_mark)+" / "+o(t.phase_skill.phase_skill_marking),1)])])]))),128))])]),e("div",De,[s(x,{mark:A.value,marking:r.marking.perf,title:"Performances"},null,8,["mark","marking"]),a(D)(r.goals)?(i(),n("ul",Ee,[(i(!0),n(b,null,k(r.goals,t=>(i(),n("li",{key:t.goal_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Me,[e("div",Pe,[e("p",Ae,o(t.goal_name),1),e("p",Ge,o(t.period.evaluation_period_name),1),t.goal_mark_is_claimed?(i(),n("p",Qe," Contesté ")):p("",!0)]),e("div",Ue,[e("p",ze,o(t.goal_expected_result),1)])]),e("div",Je,[e("div",Xe,[e("p",Ye,o(t.goal_mark)+" / "+o(t.goal_marking),1)])])]))),128))])):(i(),u(V,{key:1,message:"Les objectifs que l'évaluateur aura crée pour l'évalué s'afficherons automatiquement ici.",title:"Pas encore d'objectif."}))])]),e("div",Re,[s(x,{title:"Commentaires"}),r.validators?(i(),n("div",Ze,[s(se,{rating:r.rating,validators:r.validators},null,8,["rating","validators"])])):(i(),u(V,{key:1,message:"Les commentaires des validateurs et de l'évalué s'afficheront ici.",title:"Aucun commentaires pour l'instant. "}))]),e("div",He,[s(x,{title:"Validation"}),e("div",Ie,[e("form",{onSubmit:F(G,["prevent"])},[e("div",We,[e("div",et,[tt,st,e("div",at,[e("div",it,[e("div",rt,[s(le,{for:"start_date"}),e("div",lt,[s(re,{modelValue:a(d).rating_validator_comment,"onUpdate:modelValue":l[0]||(l[0]=t=>a(d).rating_validator_comment=t),invalid:a(d).errors.rating_validator_comment!==void 0},null,8,["modelValue","invalid"])]),s(ie,{message:a(d).errors.rating_validator_comment},null,8,["message"])])])])]),e("div",nt,[ot,dt,e("div",ct,[s(a(me),{modelValue:a(d).new_validator,"onUpdate:modelValue":l[2]||(l[2]=t=>a(d).new_validator=t)},{default:g(()=>[e("div",mt,[s(a(oe),{class:_([a(d).errors.new_validator!==void 0?"focus:ring-red-600 ring-red-600":"","w-full rounded-md border-0 bg-white py-1.5 pl-3 pr-12 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-cyan-600 sm:text-sm sm:leading-6"]),"display-value":t=>{let m=f.value.filter(y=>y.user_id===t)[0];return m?m.user_matricule+" "+m.user_display_name:"Ne pas Transférer"},placeholder:"Trouver votre N + 1",onChange:l[1]||(l[1]=t=>{S.keyword=h.value=t.target.value})},null,8,["class","display-value"]),s(a(de),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:g(()=>[s(a(ne),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})]),_:1}),f.value.length>0?(i(),u(a(ce),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:g(()=>[(i(),u(a(E),{key:-1,value:-1,as:"template"},{default:g(({active:t,selected:m})=>[e("li",{class:_(["relative cursor-default select-none py-2 pl-3 pr-9",t?"bg-cyan-600 text-white":"text-gray-900"])},[e("div",_t,[e("span",{class:_(["truncate",m&&"font-semibold"])},"Ne pas Transférer",2)]),m?(i(),n("span",{key:0,class:_(["absolute inset-y-0 right-0 flex items-center pr-4",t?"text-white":"text-cyan-600"])},[s(a(N),{"aria-hidden":"true",class:"h-5 w-5"})],2)):p("",!0)],2)]),_:1})),(i(!0),n(b,null,k(f.value,t=>(i(),u(a(E),{key:t.user_id,value:t.user_id,as:"template"},{default:g(({active:m,selected:y})=>[e("li",{class:_(["relative cursor-default select-none py-2 pl-3 pr-9",m?"bg-cyan-600 text-white":"text-gray-900"])},[e("div",ut,[e("span",{class:_(["truncate",y&&"font-semibold"])},o((t==null?void 0:t.user_matricule)+" "+(t==null?void 0:t.user_display_name)),3)]),y?(i(),n("span",{key:0,class:_(["absolute inset-y-0 right-0 flex items-center pr-4",m?"text-white":"text-cyan-600"])},[s(a(N),{"aria-hidden":"true",class:"h-5 w-5"})],2)):p("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):p("",!0)])]),_:1},8,["modelValue"])]),e("div",gt,[Y(e("input",{id:"remember-n1","onUpdate:modelValue":l[3]||(l[3]=t=>a(d).remember=t),class:"h-4 w-4 rounded border-gray-300 text-cyan-600 focus:ring-cyan-600",name:"remember-n1",type:"checkbox"},null,512),[[R,a(d).remember]]),pt])])]),e("div",ft,[s(K),e("div",null,[s(W,{disabled:r.rating.rating_is_validated,processing:a(d).processing,class:"mt-3 sm:ml-3 sm:mt-0 sm:w-auto",type:"submit"},{default:g(()=>[B(" Enregistrer ")]),_:1},8,["disabled","processing"]),e("button",{class:_([r.rating.rating_is_validated?"bg-gray-600":"bg-cyan-600 focus-visible:outline-cyan-600 hover:bg-cyan-500","inline-flex gap-x-1.5 disabled:opacity-70 rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 mt-3 sm:ml-3 sm:mt-0 sm:w-auto"]),disabled:r.rating.rating_is_validated,onClick:l[4]||(l[4]=F(t=>j.value=!0,["prevent"]))},[B("Valider "),s(a(N),{class:"text-white -mr-0.5 h-5 w-5"})],10,xt)])])],40,Ke)])])]),s(ae,{opened:j.value,validation:v.value,onCloseModal:l[5]||(l[5]=t=>j.value=!1)},null,8,["opened","validation"])]),_:1}))}};export{Mt as default};
