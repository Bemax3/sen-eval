import{Q as H,b as M,T as U,h as J,r as $,w as X,o as a,d as p,e as x,f as i,u as s,Z as R,a as e,c as l,F as b,j as w,t as n,k as _,i as O,n as u,q as Z,s as I,g as F,m as K}from"./app-589b6ab5.js";import{_ as W}from"./AuthenticatedLayout-a2654eb8.js";import{_ as ee}from"./Breadcrumbs-65bf6fa9.js";import{_ as te}from"./FormIndications-9edc05da.js";import{_ as se}from"./SubmitButton-c6a61157.js";import{_ as ae,a as ie}from"./Title-96585be5.js";import{_ as h,a as re,b as le}from"./ValidationWarning-3dcdd2d3.js";import{a as B,c as Y,m as N}from"./helper-9d93711f.js";import{b as D}from"./EmptyState-fbc63e87.js";import{_ as ne}from"./InputError-9ab85800.js";import{_ as oe}from"./TextArea-c847ba0a.js";import{_ as de}from"./InputLabel-abf86e56.js";import{r as ce}from"./ChevronUpDownIcon-b285a6e4.js";import{r as S}from"./CheckIcon-c0a2e6bc.js";import{Q as me,G as _e,X as ue,Y as E,J as ge}from"./combobox-d0bdc8b2.js";import"./logo1637145113-c7398df9.js";import"./SimpleTable-529ae7aa.js";import"./ExclamationTriangleIcon-6343b611.js";import"./use-controllable-17c4dbac.js";const pe={class:"px-4 sm:px-6 lg:px-8"},xe={role:"list"},fe={class:"px-4 py-4 sm:px-0"},ve={key:0,class:"divide-y divide-gray-100",role:"list"},he={class:"min-w-0"},ye={class:"flex items-start gap-x-3"},ke={class:"text-base font-bold leading-6 text-gray-900 dark:text-white"},be={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},we={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500 dark:text-gray-100"},Ce={class:"whitespace-break-spaces"},je={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500 dark:text-gray-100"},Ve={class:"whitespace-break-spaces"},Me={class:"flex flex-none items-center gap-x-4"},$e={class:"flex items-center justify-center space-x-4"},Ye={class:"ml-0.5 font-bold"},Ne={class:"px-4 py-4 sm:px-0"},De={class:"divide-y divide-gray-100",role:"list"},Se={class:"min-w-0"},Te={class:"flex items-start gap-x-3"},Le={class:"text-base font-bold leading-6 text-gray-900 dark:text-white"},qe={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},He={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500 dark:text-gray-100"},Oe={class:"whitespace-break-spaces"},Fe={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500 dark:text-gray-100"},Be={class:"whitespace-break-spaces"},Ee={class:"flex flex-none items-center gap-x-4"},ze={class:"flex items-center justify-center space-x-4"},Ae={class:"ml-0.5 font-bold"},Ge={class:"px-4 py-4 sm:px-0"},Pe={key:0,class:"divide-y divide-gray-100",role:"list"},Qe={class:"min-w-0"},Ue={class:"flex items-start gap-x-3"},Je={class:"text-base font-bold leading-6 text-gray-900 dark:text-white"},Xe={class:"text-white bg-gray-500 ring-gray-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Re={key:0,class:"text-red-700 bg-red-50 ring-red-600/20 rounded-md whitespace-nowrap mt-0.5 px-1.5 py-0.5 text-xs font-medium ring-1 ring-inset"},Ze={class:"mt-1 flex items-center gap-x-2 text-base leading-5 text-gray-500 dark:text-gray-100"},Ie={class:"whitespace-break-spaces"},Ke={key:0,class:"mt-1 flex items-center gap-x-2 text-sm leading-5 text-gray-500 dark:text-gray-100"},We={class:"whitespace-break-spaces"},et={class:"flex flex-none items-center gap-x-4"},tt={class:"flex items-center justify-center space-x-4"},st={class:"ml-0.5 font-bold"},at={class:"px-4 py-4 sm:px-0"},it={key:0},rt={class:"px-4 py-4 sm:px-0"},lt={class:"mt-8 bg-white dark:bg-grayish shadow sm:rounded-lg"},nt=["onSubmit"],ot={class:"grid grid-cols-1 gap-2 sm:grid-cols-2"},dt={class:"px-4 py-5 sm:p-6"},ct=e("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},"Commentaire",-1),mt=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500 dark:text-gray-100"},[e("p",null,"Ajouter un commentaire. ")],-1),_t={class:"mt-5 sm:flex sm:items-center"},ut={class:"w-full sm:max-w-xl"},gt={class:"col-span-full"},pt={class:"mt-2"},xt={class:"px-4 py-5 sm:p-6"},ft=e("h3",{class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},"Transférer",-1),vt=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500 dark:text-gray-100"},[e("p",null,"Transférer l'évaluation au supérieur hiérarchique. ")],-1),ht={class:"mt-6 w-full sm:max-w-xl"},yt={class:"relative"},kt={class:"flex"},bt={class:"flex"},wt={class:"mt-3 flex items-center"},Ct=e("label",{class:"ml-3 block text-sm leading-6 text-gray-900 dark:text-white",for:"remember-n1"},"Sauvegarder en tant que mon N + 1",-1),jt={class:"flex items-center justify-between gap-x-6 border-t border-gray-900/10 px-4 py-4 sm:px-8"},Vt=["disabled"],Ut={__name:"ValidateRating",props:{rating:{type:Object},agent:{type:Object},marking:{},specific_skills:{type:Object},skills:{type:Object},goals:{type:Object},validators:{},n1:{type:Object},others:{}},setup(r){var L,q;const f=r,z=H().props.auth.user,A=[{name:"Mes Validations",href:route("ratings.index"),current:!1},{name:"Évaluation",href:"#",current:!0}],G=M(()=>{let d=0;return f.goals.forEach(o=>d+=o.goal_mark),d}),C=M(()=>f.validators.filter(d=>d.validator_id===f.rating.evaluated_id)[0]),g=M(()=>f.validators.filter(d=>d.validator_id===z.user_id)[0]),c=U({remember:!1,validator_id:(L=g.value)==null?void 0:L.validator_id,rating_validator_comment:((q=g.value)==null?void 0:q.rating_validator_comment)||"",new_validator:-1}),T=J({keyword:"",fields:["user_matricule","user_display_name"]}),j=f.others,y=$(""),v=$(j),V=$(!1),P=()=>{c.put(route("validations.update",{validation:g.value.rating_validator_id}),{onError:d=>{H().props.flash.notify={type:"error",message:d.rating_validator_comment}},preserveScroll:!0})},Q=()=>K.post(route("users.search"),T);return X(()=>y.value,function(d){let o=d===""?j:j.filter(t=>t.user_matricule.toLowerCase().includes(y.value.toLowerCase())||t.user_display_name.toLowerCase().includes(y.value.toLowerCase()));o.length>0?v.value=o:d.length>=3&&Q().then(t=>v.value=t.data)}),(d,o)=>(a(),p(W,null,{default:x(()=>[i(s(R),{title:"Évaluation"}),e("div",pe,[i(ee,{pages:A}),i(ae,{agent:r.agent,rating:r.rating},null,8,["agent","rating"]),i(ie,{agent_id:r.agent.user_id,rating_id:r.rating.rating_id,validator:!0},null,8,["agent_id","rating_id"]),e("div",xe,[e("div",fe,[i(h,{mark:r.rating.specific_skills_sum_rating_skill_mark,marking:r.marking.specific,title:"Compétences Spécifiques (Savoir, Savoir Faire, Savoir Être)"},null,8,["mark","marking"]),s(B)(r.specific_skills)?(a(),l("ul",ve,[(a(!0),l(b,null,w(r.specific_skills,t=>(a(),l("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",he,[e("div",ye,[e("p",ke,n(t.rating_skill_name||t.phase_skill.skill.skill_name),1),t.rating_skill_mark_is_claimed?(a(),l("p",be," Contesté")):_("",!0)]),e("div",we,[e("p",Ce,n(t.phase_skill.skill.skill_desc),1)]),t.rating_skill_mark>0?(a(),l("div",je,[e("p",Ve,"Note attribué le "+n(s(Y)(s(N)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):_("",!0)]),e("div",Me,[e("div",$e,[e("p",Ye,n(t.rating_skill_mark)+" / "+n(t.phase_skill.phase_skill_marking),1)])])]))),128))])):(a(),p(D,{key:1,message:"Les compétences évaluées s'afficheront ici.",title:"Pas encore de compétences évaluées."}))]),e("div",Ne,[i(h,{mark:r.rating.general_skills_sum_rating_skill_mark,marking:r.marking.general,title:"Compétences Générales"},null,8,["mark","marking"]),e("ul",De,[(a(!0),l(b,null,w(r.skills,t=>(a(),l("li",{key:t.rating_skill_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Se,[e("div",Te,[e("p",Le,n(t.phase_skill.skill.skill_name),1),t.rating_skill_mark_is_claimed?(a(),l("p",qe," Contesté")):_("",!0)]),e("div",He,[e("p",Oe,n(t.phase_skill.skill.skill_desc),1)]),t.rating_skill_mark>0?(a(),l("div",Fe,[e("p",Be,"Note attribué le "+n(s(Y)(s(N)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):_("",!0)]),e("div",Ee,[e("div",ze,[e("p",Ae,n(t.rating_skill_mark)+" / "+n(t.phase_skill.phase_skill_marking),1)])])]))),128))])]),e("div",Ge,[i(h,{mark:G.value,marking:r.marking.perf,title:"Performances"},null,8,["mark","marking"]),s(B)(r.goals)?(a(),l("ul",Pe,[(a(!0),l(b,null,w(r.goals,t=>(a(),l("li",{key:t.goal_id,class:"flex items-center justify-between gap-x-6 py-5"},[e("div",Qe,[e("div",Ue,[e("p",Je,n(t.goal_name),1),e("p",Xe,n(t.period.evaluation_period_name),1),t.goal_mark_is_claimed?(a(),l("p",Re," Contesté ")):_("",!0)]),e("div",Ze,[e("p",Ie," Taux de réalisation : "+n(t.goal_rate)+" % / Valeur Cible : "+n(t.goal_expected_result)+" % ",1)]),t.goal_mark>0?(a(),l("div",Ke,[e("p",We,"Note attribué le "+n(s(Y)(s(N)(t.updated_at).format("DD MMMM YYYY à HH:mm"))),1)])):_("",!0)]),e("div",et,[e("div",tt,[e("p",st,n(t.goal_mark)+" / "+n(t.goal_marking),1)])])]))),128))])):(a(),p(D,{key:1,message:"Les objectifs que l'évaluateur aura crée pour l'évalué s'afficherons automatiquement ici.",title:"Pas encore d'objectif."}))])]),e("div",at,[i(h,{title:"Commentaires"}),r.validators?(a(),l("div",it,[i(re,{rating:r.rating,validators:r.validators},null,8,["rating","validators"])])):(a(),p(D,{key:1,message:"Les commentaires des validateurs et de l'évalué s'afficheront ici.",title:"Aucun commentaires pour l'instant. "}))]),e("div",rt,[i(h,{title:"Validation"}),e("div",lt,[e("form",{onSubmit:O(P,["prevent"])},[e("div",ot,[e("div",dt,[ct,mt,e("div",_t,[e("div",ut,[e("div",gt,[i(de,{for:"start_date"}),e("div",pt,[i(oe,{modelValue:s(c).rating_validator_comment,"onUpdate:modelValue":o[0]||(o[0]=t=>s(c).rating_validator_comment=t),invalid:s(c).errors.rating_validator_comment!==void 0},null,8,["modelValue","invalid"])]),i(ne,{message:s(c).errors.rating_validator_comment},null,8,["message"])])])])]),e("div",xt,[ft,vt,e("div",ht,[i(s(ge),{modelValue:s(c).new_validator,"onUpdate:modelValue":o[2]||(o[2]=t=>s(c).new_validator=t)},{default:x(()=>[e("div",yt,[i(s(me),{class:u([s(c).errors.new_validator!==void 0?"focus:ring-red-600 ring-red-600":"","w-full rounded-md border-0 bg-white dark:bg-grayish py-1.5 pl-3 pr-12 text-gray-900 dark:text-white shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-cyan-700 sm:text-sm sm:leading-6"]),"display-value":t=>{let m=v.value.filter(k=>k.user_id===t)[0];return m?m.user_matricule+" "+m.user_display_name:"Ne pas Transférer"},placeholder:"Trouver votre N + 1",onChange:o[1]||(o[1]=t=>{T.keyword=y.value=t.target.value})},null,8,["class","display-value"]),i(s(_e),{class:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none"},{default:x(()=>[i(s(ce),{"aria-hidden":"true",class:"h-5 w-5 text-gray-400"})]),_:1}),v.value.length>0?(a(),p(s(ue),{key:0,class:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white dark:bg-grayish py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm"},{default:x(()=>[(a(),p(s(E),{key:-1,value:-1,as:"template"},{default:x(({active:t,selected:m})=>[e("li",{class:u(["relative cursor-default select-none py-2 pl-3 pr-9",t?"bg-cyan-600  text-white":"text-gray-900 dark:text-white"])},[e("div",kt,[e("span",{class:u(["truncate",m&&"font-semibold"])},"Ne pas Transférer",2)]),m?(a(),l("span",{key:0,class:u(["absolute inset-y-0 right-0 flex items-center pr-4",t?"text-white":"text-cyan-600"])},[i(s(S),{"aria-hidden":"true",class:"h-5 w-5"})],2)):_("",!0)],2)]),_:1})),(a(!0),l(b,null,w(v.value,t=>(a(),p(s(E),{key:t.user_id,value:t.user_id,as:"template"},{default:x(({active:m,selected:k})=>[e("li",{class:u(["relative cursor-default select-none py-2 pl-3 pr-9",m?"bg-cyan-600  text-white":"text-gray-900 dark:text-white"])},[e("div",bt,[e("span",{class:u(["truncate",k&&"font-semibold"])},n((t==null?void 0:t.user_matricule)+" "+(t==null?void 0:t.user_display_name)),3)]),k?(a(),l("span",{key:0,class:u(["absolute inset-y-0 right-0 flex items-center pr-4",m?"text-white":"text-cyan-600"])},[i(s(S),{"aria-hidden":"true",class:"h-5 w-5"})],2)):_("",!0)],2)]),_:2},1032,["value"]))),128))]),_:1})):_("",!0)])]),_:1},8,["modelValue"])]),e("div",wt,[Z(e("input",{id:"remember-n1","onUpdate:modelValue":o[3]||(o[3]=t=>s(c).remember=t),class:"h-4 w-4 rounded border-gray-300 text-cyan-600 focus:ring-cyan-700",name:"remember-n1",type:"checkbox"},null,512),[[I,s(c).remember]]),Ct])])]),e("div",jt,[i(te),e("div",null,[i(se,{disabled:r.rating.rating_is_validated||g.value.has_validated||!C.value.has_validated,processing:s(c).processing,class:"mt-3 sm:ml-3 sm:mt-0 sm:w-auto",type:"submit"},{default:x(()=>[F(" Enregistrer ")]),_:1},8,["disabled","processing"]),e("button",{class:u([r.rating.rating_is_validated||g.value.has_validated||!C.value.has_validated?"bg-gray-600":"bg-cyan-600  focus-visible:outline-cyan-600 hover:bg-cyan-700    ","inline-flex gap-x-1.5 disabled:opacity-70 rounded-md px-3 py-2 text-sm font-semibold text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 mt-3 sm:ml-3 sm:mt-0 sm:w-auto"]),disabled:r.rating.rating_is_validated||g.value.has_validated||!C.value.has_validated,onClick:o[4]||(o[4]=O(t=>V.value=!0,["prevent"]))},[F("Valider "),i(s(S),{class:"text-white -mr-0.5 h-5 w-5"})],10,Vt)])])],40,nt)])])]),i(le,{opened:V.value,validation:g.value,onCloseModal:o[5]||(o[5]=t=>V.value=!1)},null,8,["opened","validation"])]),_:1}))}};export{Ut as default};
